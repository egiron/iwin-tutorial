
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../about/">
      
      
      
      <link rel="icon" href="../assets/images/favicon.ico">
      <meta name="generator" content="mkdocs-1.5.2, mkdocs-material-9.2.3">
    
    
      
        <title>API - IWIN documantation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.0e669242.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.85d0ee34.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="lime">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#api-references" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="IWIN documantation" class="md-header__button md-logo" aria-label="IWIN documantation" data-md-component="logo">
      
  <img src="../assets/logo_iwin2.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            IWIN documantation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              API
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="lime"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="lime"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
</form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../about/" class="md-tabs__link">
        
  
    
  
  About

      </a>
    </li>
  

      
        
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="./" class="md-tabs__link">
        
  
    
  
  API

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="IWIN documantation" class="md-nav__button md-logo" aria-label="IWIN documantation" data-md-component="logo">
      
  <img src="../assets/logo_iwin2.png" alt="logo">

    </a>
    IWIN documantation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../about/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    API
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    API
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#iwin" class="md-nav__link">
    iwin
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iwin.HT" class="md-nav__link">
    HT
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iwin.Site" class="md-nav__link">
    Site
  </a>
  
    <nav class="md-nav" aria-label="Site">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#iwin.Site.getRangeDates" class="md-nav__link">
    getRangeDates()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.Site.getPhenologyDates" class="md-nav__link">
    getPhenologyDates()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.Site.getEstimatedEmergence" class="md-nav__link">
    getEstimatedEmergence()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.Site.getEstimatedHeading" class="md-nav__link">
    getEstimatedHeading()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.Site.getEstimatedMaturity" class="md-nav__link">
    getEstimatedMaturity()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.Site.getEstimatedPhenologyDates" class="md-nav__link">
    getEstimatedPhenologyDates()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.Site.getWeather" class="md-nav__link">
    getWeather()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.Site.getSowingDOY" class="md-nav__link">
    getSowingDOY()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.Site.getDayLength" class="md-nav__link">
    getDayLength()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.Site.getDayLengthDAP" class="md-nav__link">
    getDayLengthDAP()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.Site.getTDay" class="md-nav__link">
    getTDay()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.Site.getGDD" class="md-nav__link">
    getGDD()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.Site.getPRFT" class="md-nav__link">
    getPRFT()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.Site.getEmergenceDate" class="md-nav__link">
    getEmergenceDate()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.Site.getDaysToHeading" class="md-nav__link">
    getDaysToHeading()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.Site.getMaturityDate" class="md-nav__link">
    getMaturityDate()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.Site.getWeatherParameters" class="md-nav__link">
    getWeatherParameters()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.Site.setupIPAR" class="md-nav__link">
    setupIPAR()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.Site.getNormalizeThermalTime" class="md-nav__link">
    getNormalizeThermalTime()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.Site.updateWeatherparams" class="md-nav__link">
    updateWeatherparams()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.Site.estimateNDVI" class="md-nav__link">
    estimateNDVI()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.Site.estimateNDVI_EH" class="md-nav__link">
    estimateNDVI_EH()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.Site.estimateNDVI_HM" class="md-nav__link">
    estimateNDVI_HM()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.Site.getIPAR" class="md-nav__link">
    getIPAR()
  </a>
  
    <nav class="md-nav" aria-label="getIPAR()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#iwin.Site.getIPAR--asrar-g-fuchs-m-kanemasu-et-hatfield-jl-1984" class="md-nav__link">
    ** Asrar, G., Fuchs, M., Kanemasu, E.T., Hatfield, J.L., 1984.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.Site.getIPAR--estimating-absorbed-photosynthetic-radiation-and-leaf-area-index-from-spectral-reflectance" class="md-nav__link">
    Estimating absorbed photosynthetic radiation and leaf area index from spectral reflectance
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.Site.getIPAR--in-wheat-agron-j-76-300306" class="md-nav__link">
    in wheat. Agron. J. 76, 300–306.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.Site.getIPAR---campos-2018-remote-sensing-based-crop-biomass-with-water-or-light-driven-crop-growth-models-in" class="md-nav__link">
    - Campos 2018 Remote sensing-based crop biomass with water or light-driven crop growth models in
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.Site.getIPAR--wheat-commercial-fields" class="md-nav__link">
    wheat commercial fields
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.Site.fit" class="md-nav__link">
    fit()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iwin.gxe" class="md-nav__link">
    gxe
  </a>
  
    <nav class="md-nav" aria-label="gxe">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#iwin.gxe.Nursery" class="md-nav__link">
    Nursery
  </a>
  
    <nav class="md-nav" aria-label="Nursery">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#iwin.gxe.Nursery.getAvgYieldbyNurseryYear" class="md-nav__link">
    getAvgYieldbyNurseryYear()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.gxe.Nursery.genotypeSelection_byLinearRegression" class="md-nav__link">
    genotypeSelection_byLinearRegression()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.gxe.Nursery.getEnvironment" class="md-nav__link">
    getEnvironment()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.gxe.Nursery.getClass_old" class="md-nav__link">
    getClass_old()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.gxe.Nursery.getClass" class="md-nav__link">
    getClass()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.gxe.Nursery.getNumOfOcurrences" class="md-nav__link">
    getNumOfOcurrences()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.gxe.Nursery.getNumOfOcurrences_old" class="md-nav__link">
    getNumOfOcurrences_old()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.gxe.Nursery.processLRMethods" class="md-nav__link">
    processLRMethods()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.gxe.Nursery.processClassificationMethod_old" class="md-nav__link">
    processClassificationMethod_old()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.gxe.Nursery.processClassificationMethod" class="md-nav__link">
    processClassificationMethod()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.gxe.Nursery.commonGIDsinMethods" class="md-nav__link">
    commonGIDsinMethods()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.gxe.Nursery.commonGIDsinMethods_v2" class="md-nav__link">
    commonGIDsinMethods_v2()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.gxe.Nursery.prepareDatasetforGEmodel" class="md-nav__link">
    prepareDatasetforGEmodel()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.gxe.Nursery.GEmeans" class="md-nav__link">
    GEmeans()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.gxe.Nursery.ge_impute_missing_values" class="md-nav__link">
    ge_impute_missing_values()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.gxe.Nursery.geAMMI" class="md-nav__link">
    geAMMI()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.gxe.Nursery.geGGE" class="md-nav__link">
    geGGE()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.gxe.Nursery.gge_rankingG" class="md-nav__link">
    gge_rankingG()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.gxe.Nursery.gge_www" class="md-nav__link">
    gge_www()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.gxe.Nursery.extract_Weather" class="md-nav__link">
    extract_Weather()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.gxe.Nursery.extract_Weather_growthStages" class="md-nav__link">
    extract_Weather_growthStages()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.gxe.ammi" class="md-nav__link">
    ammi
  </a>
  
    <nav class="md-nav" aria-label="ammi">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#iwin.gxe.ammi.AMMI" class="md-nav__link">
    AMMI
  </a>
  
    <nav class="md-nav" aria-label="AMMI">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#iwin.gxe.ammi.AMMI.cal_env_residuals" class="md-nav__link">
    cal_env_residuals()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.gxe.ammi.AMMI.calc_gen_residuals" class="md-nav__link">
    calc_gen_residuals()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.gxe.ammi.AMMI.plot" class="md-nav__link">
    plot()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.gxe.gge" class="md-nav__link">
    gge
  </a>
  
    <nav class="md-nav" aria-label="gge">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#iwin.gxe.gge.GGE" class="md-nav__link">
    GGE
  </a>
  
    <nav class="md-nav" aria-label="GGE">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#iwin.gxe.gge.GGE.best_G" class="md-nav__link">
    best_G()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.gxe.gge.GGE.calc_env_residuals" class="md-nav__link">
    calc_env_residuals()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.gxe.gge.GGE.calc_gen_residuals" class="md-nav__link">
    calc_gen_residuals()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.gxe.gge.GGE.get_twoway_table" class="md-nav__link">
    get_twoway_table()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.gxe.gge.GGE.impute_missing_values" class="md-nav__link">
    impute_missing_values()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.gxe.gge.GGE.prepare_data" class="md-nav__link">
    prepare_data()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.gxe.gge.GGE.getMegaEnvironments" class="md-nav__link">
    getMegaEnvironments()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.gxe.gge.GGE.plot" class="md-nav__link">
    plot()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iwin.util" class="md-nav__link">
    util
  </a>
  
    <nav class="md-nav" aria-label="util">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#iwin.util.is_number" class="md-nav__link">
    is_number()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.util.getDOY" class="md-nav__link">
    getDOY()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.util.find_nearest_value" class="md-nav__link">
    find_nearest_value()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.util.find_nearest_index" class="md-nav__link">
    find_nearest_index()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.util.find_nearest" class="md-nav__link">
    find_nearest()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.util.getScores" class="md-nav__link">
    getScores()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.util.getAccuracy" class="md-nav__link">
    getAccuracy()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.util.missing_values_table" class="md-nav__link">
    missing_values_table()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.util.missingData" class="md-nav__link">
    missingData()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.util.findNearest_point" class="md-nav__link">
    findNearest_point()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.util.getExtrapoledLine" class="md-nav__link">
    getExtrapoledLine()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.util.custom_rolling" class="md-nav__link">
    custom_rolling()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.util.assignME" class="md-nav__link">
    assignME()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.util.normalize_Yield" class="md-nav__link">
    normalize_Yield()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.util.tidy_corr_matrix" class="md-nav__link">
    tidy_corr_matrix()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.util.idenfifyTargetGIDs_byNurseryYear" class="md-nav__link">
    idenfifyTargetGIDs_byNurseryYear()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.util.filterTargetGIDs_byThresholdMaxTemperature" class="md-nav__link">
    filterTargetGIDs_byThresholdMaxTemperature()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.util.displayMap_spatialDistSelectedGIDs" class="md-nav__link">
    displayMap_spatialDistSelectedGIDs()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.util.displayGenotypeSensitivitybyWeather" class="md-nav__link">
    displayGenotypeSensitivitybyWeather()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.util.displayTempVsGY_inGrowStagesforAllGIDs" class="md-nav__link">
    displayTempVsGY_inGrowStagesforAllGIDs()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.util.drawTemperaturebyGrowthStage_acrossYears" class="md-nav__link">
    drawTemperaturebyGrowthStage_acrossYears()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.util.drawTemperaturebyGrowthStage_acrossYears_v2" class="md-nav__link">
    drawTemperaturebyGrowthStage_acrossYears_v2()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.util.drawRegCoefficientbyGrowthStage_acrossYears" class="md-nav__link">
    drawRegCoefficientbyGrowthStage_acrossYears()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.util.drawCompareGYvsTMAXbyGS" class="md-nav__link">
    drawCompareGYvsTMAXbyGS()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.util.ranking_selectedGenotypes" class="md-nav__link">
    ranking_selectedGenotypes()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.util.getVarietyCounts" class="md-nav__link">
    getVarietyCounts()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.util.searchParenLines" class="md-nav__link">
    searchParenLines()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.util.seachWheatLinesInExtremeWeather" class="md-nav__link">
    seachWheatLinesInExtremeWeather()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.util.figures" class="md-nav__link">
    figures
  </a>
  
    <nav class="md-nav" aria-label="figures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#iwin.util.figures.chart_compareResults" class="md-nav__link">
    chart_compareResults()
  </a>
  
    <nav class="md-nav" aria-label="chart_compareResults()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#iwin.util.figures.chart_compareResults--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.util.figures.chart_compareResults--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.util.figures.chart_compareYieldResults" class="md-nav__link">
    chart_compareYieldResults()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.util.figures.chart_compareDaysFromStagesResults" class="md-nav__link">
    chart_compareDaysFromStagesResults()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.util.figures.chartObsYieldTrendsAllNurseries" class="md-nav__link">
    chartObsYieldTrendsAllNurseries()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.util.figures.chartAvgObsYieldTrendsAllNurseries" class="md-nav__link">
    chartAvgObsYieldTrendsAllNurseries()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.util.figures.figure_AvgYieldbyGID_LR" class="md-nav__link">
    figure_AvgYieldbyGID_LR()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.util.figures.figure_AvgYieldbyGID_classify" class="md-nav__link">
    figure_AvgYieldbyGID_classify()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.util.figures.figure_AvgYieldbyGID_classify_v2" class="md-nav__link">
    figure_AvgYieldbyGID_classify_v2()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.util.figures.plot_AvgYieldbyGID_classify" class="md-nav__link">
    plot_AvgYieldbyGID_classify()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.util.figures.figure_AvgYieldbyGID_combineMethods" class="md-nav__link">
    figure_AvgYieldbyGID_combineMethods()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.util.figures.clusterYieldEnvironments" class="md-nav__link">
    clusterYieldEnvironments()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.util.figures.chartObsYieldTrends" class="md-nav__link">
    chartObsYieldTrends()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iwin.stats" class="md-nav__link">
    stats
  </a>
  
    <nav class="md-nav" aria-label="stats">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#iwin.stats.prepareDatasetforR" class="md-nav__link">
    prepareDatasetforR()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.stats.joinBLUPnBLUE_andNormilizedYield_GrpByGID" class="md-nav__link">
    joinBLUPnBLUE_andNormilizedYield_GrpByGID()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iwin.iparyield" class="md-nav__link">
    iparyield
  </a>
  
    <nav class="md-nav" aria-label="iparyield">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model" class="md-nav__link">
    model
  </a>
  
    <nav class="md-nav" aria-label="model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.iPARModel" class="md-nav__link">
    iPARModel
  </a>
  
    <nav class="md-nav" aria-label="iPARModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.iPARModel.load_raw_datasets" class="md-nav__link">
    load_raw_datasets()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.iPARModel.load_datasets" class="md-nav__link">
    load_datasets()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.iPARModel.filterPhenologyData" class="md-nav__link">
    filterPhenologyData()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.iPARModel.prepareData" class="md-nav__link">
    prepareData()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.iPARModel.prepareData_toExtractWeather" class="md-nav__link">
    prepareData_toExtractWeather()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.iPARModel.process_ClimateStatsforGrowthStage" class="md-nav__link">
    process_ClimateStatsforGrowthStage()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.iPARModel.process_ClimateStatsforGrowthPeriod_v3" class="md-nav__link">
    process_ClimateStatsforGrowthPeriod_v3()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.iPARModel.process_GapFillingforPhenology" class="md-nav__link">
    process_GapFillingforPhenology()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.iPARModel.process_GapFillingforPhenology_v3" class="md-nav__link">
    process_GapFillingforPhenology_v3()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.iPARModel.fit" class="md-nav__link">
    fit()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.iPARModel.runModel" class="md-nav__link">
    runModel()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.iPARModel.extractClimatexBestPedigreeSelection" class="md-nav__link">
    extractClimatexBestPedigreeSelection()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.iPARModel.estimateWeatherPhenology_byObs" class="md-nav__link">
    estimateWeatherPhenology_byObs()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.tadjday" class="md-nav__link">
    tadjday
  </a>
  
    <nav class="md-nav" aria-label="tadjday">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.tadjday.calcTAdjDay" class="md-nav__link">
    calcTAdjDay()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.tadjday.getTAdjDay" class="md-nav__link">
    getTAdjDay()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.tadjday.apply_TAdjDay" class="md-nav__link">
    apply_TAdjDay()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.tadjday.estimate_TAdjDay" class="md-nav__link">
    estimate_TAdjDay()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.gdd" class="md-nav__link">
    gdd
  </a>
  
    <nav class="md-nav" aria-label="gdd">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.gdd.calcGDD" class="md-nav__link">
    calcGDD()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.gdd.getGDD" class="md-nav__link">
    getGDD()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.gdd.apply_GDD" class="md-nav__link">
    apply_GDD()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.gdd.calculateGDD" class="md-nav__link">
    calculateGDD()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.prft" class="md-nav__link">
    prft
  </a>
  
    <nav class="md-nav" aria-label="prft">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.prft.calcPRFT" class="md-nav__link">
    calcPRFT()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.prft.apply_PRFT" class="md-nav__link">
    apply_PRFT()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.prft.calculatePRFT" class="md-nav__link">
    calculatePRFT()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.ipar" class="md-nav__link">
    ipar
  </a>
  
    <nav class="md-nav" aria-label="ipar">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.ipar.calcIPAR" class="md-nav__link">
    calcIPAR()
  </a>
  
    <nav class="md-nav" aria-label="calcIPAR()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.ipar.calcIPAR--asrar-g-fuchs-m-kanemasu-et-hatfield-jl-1984" class="md-nav__link">
    ** Asrar, G., Fuchs, M., Kanemasu, E.T., Hatfield, J.L., 1984.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.ipar.calcIPAR--estimating-absorbed-photosynthetic-radiation-and-leaf-area-index-from-spectral-reflectance" class="md-nav__link">
    Estimating absorbed photosynthetic radiation and leaf area index from spectral reflectance
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.ipar.calcIPAR--in-wheat-agron-j-76-300306" class="md-nav__link">
    in wheat. Agron. J. 76, 300–306.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.ipar.calcIPAR---campos-2018-remote-sensing-based-crop-biomass-with-water-or-light-driven-crop-growth-models-in" class="md-nav__link">
    - Campos 2018 Remote sensing-based crop biomass with water or light-driven crop growth models in
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.ipar.calcIPAR--wheat-commercial-fields" class="md-nav__link">
    wheat commercial fields
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.ipar.getIPAR_EH" class="md-nav__link">
    getIPAR_EH()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.ipar.apply_IPAR_EH" class="md-nav__link">
    apply_IPAR_EH()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.ipar.estimate_IPAR" class="md-nav__link">
    estimate_IPAR()
  </a>
  
    <nav class="md-nav" aria-label="estimate_IPAR()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.ipar.estimate_IPAR--asrar-g-fuchs-m-kanemasu-et-hatfield-jl-1984" class="md-nav__link">
    ** Asrar, G., Fuchs, M., Kanemasu, E.T., Hatfield, J.L., 1984.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.ipar.estimate_IPAR--estimating-absorbed-photosynthetic-radiation-and-leaf-area-index-from-spectral-reflectance" class="md-nav__link">
    Estimating absorbed photosynthetic radiation and leaf area index from spectral reflectance
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.ipar.estimate_IPAR--in-wheat-agron-j-76-300306" class="md-nav__link">
    in wheat. Agron. J. 76, 300–306.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.ipar.estimate_IPAR---campos-2018-remote-sensing-based-crop-biomass-with-water-or-light-driven-crop-growth-models-in" class="md-nav__link">
    - Campos 2018 Remote sensing-based crop biomass with water or light-driven crop growth models in
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.ipar.estimate_IPAR--wheat-commercial-fields" class="md-nav__link">
    wheat commercial fields
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.daylength" class="md-nav__link">
    daylength
  </a>
  
    <nav class="md-nav" aria-label="daylength">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.daylength.CBM_daylength" class="md-nav__link">
    CBM_daylength()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.daylength.getDaylength" class="md-nav__link">
    getDaylength()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.daylength.apply_Daylength" class="md-nav__link">
    apply_Daylength()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.daylength.calculateDayLength" class="md-nav__link">
    calculateDayLength()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.ndvi" class="md-nav__link">
    ndvi
  </a>
  
    <nav class="md-nav" aria-label="ndvi">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.ndvi.estimateNDVI_EH" class="md-nav__link">
    estimateNDVI_EH()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.ndvi.estimateNDVI_HM" class="md-nav__link">
    estimateNDVI_HM()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.ndvi.getNDVI_EH" class="md-nav__link">
    getNDVI_EH()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.ndvi.apply_NDVI_EH" class="md-nav__link">
    apply_NDVI_EH()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.ndvi.calculateNDVI_EH" class="md-nav__link">
    calculateNDVI_EH()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.ndvi.getNDVI_HM" class="md-nav__link">
    getNDVI_HM()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.ndvi.apply_NDVI_HM" class="md-nav__link">
    apply_NDVI_HM()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.ndvi.calculateNDVI_HM" class="md-nav__link">
    calculateNDVI_HM()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.tday" class="md-nav__link">
    tday
  </a>
  
    <nav class="md-nav" aria-label="tday">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.tday.calcTDay" class="md-nav__link">
    calcTDay()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.tday.getTDay" class="md-nav__link">
    getTDay()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.tday.apply_TDay" class="md-nav__link">
    apply_TDay()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.iparyield.model.tday.estimate_TDay" class="md-nav__link">
    estimate_TDay()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iwin.data" class="md-nav__link">
    data
  </a>
  
    <nav class="md-nav" aria-label="data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#iwin.data.load_data" class="md-nav__link">
    load_data()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.data.load_IWINdataset" class="md-nav__link">
    load_IWINdataset()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.data.filterPhenologyData" class="md-nav__link">
    filterPhenologyData()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.data.imputingMissingValues" class="md-nav__link">
    imputingMissingValues()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.data.displaySummaryByNursery" class="md-nav__link">
    displaySummaryByNursery()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.data.joinBLUPnBLUE_andNormilizedYield_GrpByGID" class="md-nav__link">
    joinBLUPnBLUE_andNormilizedYield_GrpByGID()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.data.getStatsByTrial" class="md-nav__link">
    getStatsByTrial()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.data.createArrayOfObjects_toRunInParallel" class="md-nav__link">
    createArrayOfObjects_toRunInParallel()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iwin.data.formatFeaturesforIWIN" class="md-nav__link">
    formatFeaturesforIWIN()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    References
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="api-references">API references</h1>


<div class="doc doc-object doc-module">


<a id="iwin"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="iwin.HT" class="doc doc-heading">
          <code>iwin.HT</code>


</h2>


  <div class="doc doc-contents ">

  
      <p>Colors class:</p>



<p><strong>Examples:</strong></p>
    <ul>
<li>Reset all colors with colors.reset</li>
<li>Two subclasses fg for foreground and bg for background.</li>
</ul>
<p>Use as colors.subclass.colorname.
i.e. colors.fg.red or colors.bg.green</p>
<p>Also, the generic bold, disable, underline, reverse, strikethrough,
and invisible work with the main class
i.e. colors.bold</p>


  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="iwin.Site" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">Site</span><span class="p">(</span><span class="n">uid</span><span class="p">,</span> <span class="n">loc</span><span class="p">,</span> <span class="n">attributes</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code>object</code></p>

  
      <p>Object containing attributes and functions related to the nursery site.</p>
  

<details class="warning" open>
  <summary>Deprecated</summary>
  <p>Stop using this class.</p>
</details>


  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>uid</code></td>
          <td>
                <code>integer</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The unique identifier for the site.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>loc</code></td>
          <td>
                <code>integer</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The number of the location.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>attributes</code></td>
          <td>
                <code>object</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The default attributes for each location in IWIN dataset.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>params</code></td>
          <td>
                <code>dictionary</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The parameters to use during calculations.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Other Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>whatever</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Some integer.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>attributes</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Human readable string describing the attributes collected for a particular site.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="return" open>
  <summary>Return</summary>
  <p>A site with all attributes during processing.</p>
</details>


<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;hello&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="go">hello</span>
</code></pre></div>

<details class="todo" open>
  <summary>Todo</summary>
  <ul>
<li>For module TODOs</li>
<li>You have to also use <code>sphinx.ext.todo</code> extension</li>
</ul>
</details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="iwin.Site.getRangeDates" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">Site</span><span class="o">.</span><span class="n">getRangeDates</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get range dates for growing period </p>
<p>:param s: Start date eg. Sowing date
:param e: End date eg. Maturity date</p>
<p>:return: an array or pandas series with the dates in between, or None if error occurs</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.Site.getPhenologyDates" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">Site</span><span class="o">.</span><span class="n">getPhenologyDates</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get phenology dates from reported or estimated</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.Site.getEstimatedEmergence" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">Site</span><span class="o">.</span><span class="n">getEstimatedEmergence</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get Estimated Emergence</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.Site.getEstimatedHeading" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">Site</span><span class="o">.</span><span class="n">getEstimatedHeading</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get Estimated Heading</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.Site.getEstimatedMaturity" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">Site</span><span class="o">.</span><span class="n">getEstimatedMaturity</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rate</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">daysGF</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get Estimated Maturity from Observed Heading and Predicted Heading</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.Site.getEstimatedPhenologyDates" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">Site</span><span class="o">.</span><span class="n">getEstimatedPhenologyDates</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Estimated Phenology (Emergence, Heading, Maturity)</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.Site.getWeather" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">Site</span><span class="o">.</span><span class="n">getWeather</span><span class="p">(</span><span class="n">weatherDF</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get phenology dates for growing period </p>
<p>:param weatherDF: A pandas dataframe with weather data
:param s: Start date eg. Sowing date
:param e: End date eg. Maturity date</p>
<p>:return: a pandas dataframe with the filtered weather data, or None if error occurs</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.Site.getSowingDOY" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">Site</span><span class="o">.</span><span class="n">getSowingDOY</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get the Day of the Year for Sowing date</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.Site.getDayLength" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">Site</span><span class="o">.</span><span class="n">getDayLength</span><span class="p">(</span><span class="n">d</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lat</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get Day length</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.Site.getDayLengthDAP" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">Site</span><span class="o">.</span><span class="n">getDayLengthDAP</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">DAP</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get Date after planting and Day length </p>
<p>:params DAP: Days after sowing date</p>
<p>:return: tuple with Date and Daylength</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.Site.getTDay" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">Site</span><span class="o">.</span><span class="n">getTDay</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tminFactor</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Calculate day time temperature</p>
<p>:param w: Table of weather data with Minimum and Maximum Temperatures
:param tminFactor: Minimum Temperature factor</p>
<p>:return: a number or array of Day Temperature</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.Site.getGDD" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">Site</span><span class="o">.</span><span class="n">getGDD</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Tbase</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Growing degree days GDD (°F or °C)
    Calculated from: ((Daily Max Temp + Daily Min Temp)/2) - 32 °F (or 
    ((Daily Max Temp + Daily Min Temp)/2)).</p>
<p>:param Tmin: Number or array of Minimum Temperatures
:param Tmax: Number or array of Maximum Temperatures
:param Tbase: Temperature base of the crop</p>
<p>:return: a number or array of Growing degree days (GDD)</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.Site.getPRFT" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">Site</span><span class="o">.</span><span class="n">getPRFT</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">TDay</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">TOpt</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Estimate Photosynthesis reduction factor (PRFT)
    PRFT = 1 – 0.0025 * (TDay – TOpt)^2</p>
<p>:param TDay: Number or array of Day Temperatures
:param TOpt: Optimum Temperature</p>
<p>:return: a number or array of PRFT</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.Site.getEmergenceDate" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">Site</span><span class="o">.</span><span class="n">getEmergenceDate</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cGDD</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">GDDreq</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Estimate emergence date</p>
<p>Day on which cumulative thermal time reaches 180 GDD (Tbase = 0ºC)</p>
<p>:params cGDD: Cumulative Sum of GDD
:params GDDreq: GDD or thermal time required to emergence
:params ts: convert date to Timestamp</p>
<p>:return: an emergence date</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.Site.getDaysToHeading" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">Site</span><span class="o">.</span><span class="n">getDaysToHeading</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dayHR</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Estimate days to heading after sowing date</p>
<p>:params dayHR: Daylength </p>
<p>The following Curves are only applied for ESWYT, IDYN and HTWYT data sets
If daylength @ 35 DAS &lt; 10.8 hrs
    DAYS_TO_HEADING = 491.27 - 38.62 * DayLength @ 35DAS  (daylength in hours)
If daylength @ 35 DAS &gt; 10.8 hrs
    DAYS_TO_HEADING = 115.36 - 3.87 * DayLength @ 35DAS</p>
<p>SAWYT is earlier
If daylength @ 35 DAS &lt; 10.8 hrs
    DAYS_TO_HEADING = 617.68 - 51.406 * DayLength@35DAS  (daylength in hours)
If daylength @ 35 DAS &gt; 10.8 hrs
    DAYS_TO_HEADING = 87.38 – 2.36 * DayLength @ 35DAS</p>
<p>:return: Estimated days to heading after sowing date</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.Site.getMaturityDate" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">Site</span><span class="o">.</span><span class="n">getMaturityDate</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rate</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">daysGF</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Estimate maturity date from weather using TAdjDays </p>
<p>:params m: model with the global configuration, parameters and data
:params threshold: A threshold to adjust the number of temperature days
:params scale: A scale to adjust the number of temperature days
:params rate: A rate to adjust the number of temperature days
:params daysGF: Days to grain filling</p>
<p>:return: Estimated days to maturity, Maturity date and number of days between heading to maturity date.</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.Site.getWeatherParameters" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">Site</span><span class="o">.</span><span class="n">getWeatherParameters</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">season</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <div class="highlight"><pre><span></span><code>Get additional weather parameters per site
- Avg minimum temperature during growing season
- Avg maximum temperature during growing season
- Avg mean temperature during growing season
- Avg solar radiation during growing season
- Total amount of precipitation during growing season
</code></pre></div>
<p>:params weather: the weather dataset for the specific site</p>
<p>:return: An updated attributes of the site</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.Site.setupIPAR" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">Site</span><span class="o">.</span><span class="n">setupIPAR</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">_mask_EH</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">_mask_pEH</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">_mask_EpH</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">_mask_pEpH</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">_mask_HM</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">_mask_pHM</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">_mask_HpM</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">_mask_pHpM</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Setup parameters to calculate iPAR</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.Site.getNormalizeThermalTime" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">Site</span><span class="o">.</span><span class="n">getNormalizeThermalTime</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cGDD_EH</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cGDD_pEH</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cGDD_EpH</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cGDD_pEpH</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cGDD_HM</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cGDD_pHM</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cGDD_pHpM</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cGDD_HpM</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Normalize GDD or Thermal time</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.Site.updateWeatherparams" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">Site</span><span class="o">.</span><span class="n">updateWeatherparams</span><span class="p">(</span><span class="n">_mask_SE</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">_mask_SpE</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">_mask_EH</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">_mask_pEH</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">_mask_EpH</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">_mask_pEpH</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">_mask_EM</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">_mask_pEM</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">_mask_pEpM</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">_mask_SM</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">_mask_SpM</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">_mask_SH</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">_mask_SpH</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">_mask_HM</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">_mask_HpM</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">_mask_pHM</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">_mask_pHpM</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">_mask_dDAS_H</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">_mask_dDAS_pH</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">season</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Update weather statistics </p>
<p>:params _mask_SM: Filter used to get weather data from Sowing to Maturity
:params _mask_SH: Filter used to get weather data from Sowing to Heading
:params _mask_EH: Filter used to get weather data from Emergence to Heading
:params _mask_pEH: Filter used to get weather data from predicted Emergence to Heading
:params _mask_HM: Filter used to get weather data from Heading to Maturity
:params _mask_SpM: Filter used to get weather data from Sowing to estimated Maturity
:params _mask_SpH: Filter used to get weather data from Sowing to estimated Heading
:params _mask_pEpH: Filter used to get weather data from predicted Emergence to estimated Heading
:params _mask_HpM: Filter used to get weather data from Heading to estimated Maturity
:params _mask_pHpM: Filter used to get weather data from estimated Heading to estimated Maturity
:params _mask_dDAS_H: Filter used to get weather data from 35 days after Sowing to Heading
:params _mask_dDAS_pH: Filter used to get weather data from 35 days after Sowing to estimated Heading</p>
<p>:params season: Display weather statistics for different periods</p>
<p>:result: A Site with updated weather statistics</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.Site.estimateNDVI" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">Site</span><span class="o">.</span><span class="n">estimateNDVI</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Estimate NDVI values for growing cycle.</p>
<p>Use of Normalized Thermal Time and Observed NDVI to calculate IPAR 
from Emergence to Heading</p>
<p>:params Norm_TT_EH: Normalize GDD or Thermal time from Emergence to Heading</p>
<p>:return: An array with NDVI values from Emergence to Heading</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.Site.estimateNDVI_EH" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">Site</span><span class="o">.</span><span class="n">estimateNDVI_EH</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Norm_TT_EH</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Estimate NDVI values from emergence to heading.</p>
<p>Use of Normalized Thermal Time and Observed NDVI to calculate IPAR 
from Emergence to Heading</p>
<p>:params Norm_TT_EH: Normalize GDD or Thermal time from Emergence to Heading</p>
<p>:return: An array with NDVI values from Emergence to Heading</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.Site.estimateNDVI_HM" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">Site</span><span class="o">.</span><span class="n">estimateNDVI_HM</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Norm_TT_HM</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">NDVI_atHeading</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Estimate NDVI values from Heading to Maturity.</p>
<p>Use of Normalized Thermal Time and Observed NDVI to calculate IPAR 
from Heading to Maturity.</p>
<p>:params norm_TT_HM: Normalize GDD or Thermal time from Heading to Maturity
:params NDVI_max: Maximum NDVI value allowed
:params NDVI_atHeading: NDVI reached at Heading date
:verbose: Display messages during the processing</p>
<p>:return: An array with NDVI values from Heading to Maturity</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.Site.getIPAR" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">Site</span><span class="o">.</span><span class="n">getIPAR</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">norm_iPAR_EH_bounds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">NDVI_constantIPAR</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">RUE</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">YIELD_FACTOR</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Total light interception - iPAR</p>
<h4 id="iwin.Site.getIPAR--asrar-g-fuchs-m-kanemasu-et-hatfield-jl-1984">** Asrar, G., Fuchs, M., Kanemasu, E.T., Hatfield, J.L., 1984.</h4>
<h4 id="iwin.Site.getIPAR--estimating-absorbed-photosynthetic-radiation-and-leaf-area-index-from-spectral-reflectance">Estimating absorbed photosynthetic radiation and leaf area index from spectral reflectance</h4>
<h4 id="iwin.Site.getIPAR--in-wheat-agron-j-76-300306">in wheat. Agron. J. 76, 300–306.</h4>
<h4 id="iwin.Site.getIPAR---campos-2018-remote-sensing-based-crop-biomass-with-water-or-light-driven-crop-growth-models-in">- Campos 2018 Remote sensing-based crop biomass with water or light-driven crop growth models in</h4>
<h4 id="iwin.Site.getIPAR--wheat-commercial-fields">wheat commercial fields</h4>
<p>iPAR = NDVI * 1.25 - 0.19 # between heading and maturity (Campos et al. 2018)
iPAR = NDVI * 1.25 - 0.21 Daughtry et al. (1992)</p>
<hr />
<p>:params m: Model with configuration and parameters
:params norm_iPAR_EH_bounds: Bounds for iPAR multi-linear equations</p>
<p>:return: An array of Total light interception values</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.Site.fit" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">Site</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">season</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <div class="highlight"><pre><span></span><code>Run a iPAR Yield model to fit yield
</code></pre></div>
<p>:params m: Model to run
:params sites_to_run: Array of Site objects
:params season: Display weather statistics for different periods</p>
<p>:resutls: An array of Sites with intermediate results</p>

  </div>

</div>



  </div>

  </div>

</div>



<div class="doc doc-object doc-module">



<h2 id="iwin.gxe" class="doc doc-heading">
            <code>iwin.gxe</code>


</h2>

  <div class="doc doc-contents ">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="iwin.gxe.Nursery" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">gxe</span><span class="o">.</span><span class="n">Nursery</span><span class="p">(</span><span class="n">nursery</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">weather</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code>object</code></p>



  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h4 id="iwin.gxe.Nursery.getAvgYieldbyNurseryYear" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">gxe</span><span class="o">.</span><span class="n">Nursery</span><span class="o">.</span><span class="n">getAvgYieldbyNurseryYear</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nursery</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>For each nursery year, calculate the average yield of each location and Occ.</p>
<p>:params df:
:params nursery:</p>
<p>:return:</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="iwin.gxe.Nursery.genotypeSelection_byLinearRegression" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">gxe</span><span class="o">.</span><span class="n">Nursery</span><span class="o">.</span><span class="n">genotypeSelection_byLinearRegression</span><span class="p">(</span><span class="n">df_GY</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nursery</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;OLS&#39;</span><span class="p">,</span> <span class="s1">&#39;RANSAC&#39;</span><span class="p">],</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Select GIDs by linear regression lines</p>
<p>Method 1: OLS
Method 2: Robust linear regression (RANSAC)</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="iwin.gxe.Nursery.getEnvironment" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">gxe</span><span class="o">.</span><span class="n">Nursery</span><span class="o">.</span><span class="n">getEnvironment</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">avgGrainYield</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Use cross product to determine whether a point lies above or below a line.</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="iwin.gxe.Nursery.getClass_old" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">gxe</span><span class="o">.</span><span class="n">Nursery</span><span class="o">.</span><span class="n">getClass_old</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">avgGrainYield</span><span class="p">,</span> <span class="n">avgEnv</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">qd</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Use cross product to determine whether a point lies above or below a line.</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="iwin.gxe.Nursery.getClass" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">gxe</span><span class="o">.</span><span class="n">Nursery</span><span class="o">.</span><span class="n">getClass</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">avgGrainYield</span><span class="p">,</span> <span class="n">avgEnv</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">qd</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Use cross product to determine whether a point lies above or below a line.</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="iwin.gxe.Nursery.getNumOfOcurrences" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">gxe</span><span class="o">.</span><span class="n">Nursery</span><span class="o">.</span><span class="n">getNumOfOcurrences</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nursery</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">qd</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Get number of occurrences in classification method</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="iwin.gxe.Nursery.getNumOfOcurrences_old" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">gxe</span><span class="o">.</span><span class="n">Nursery</span><span class="o">.</span><span class="n">getNumOfOcurrences_old</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nursery</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;AL&#39;</span><span class="p">,</span> <span class="s1">&#39;BH&#39;</span><span class="p">,</span> <span class="s1">&#39;AH&#39;</span><span class="p">,</span> <span class="s1">&#39;BL&#39;</span><span class="p">],</span> <span class="n">qd</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Get number of occurrences in classification method</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="iwin.gxe.Nursery.processLRMethods" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">gxe</span><span class="o">.</span><span class="n">Nursery</span><span class="o">.</span><span class="n">processLRMethods</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nursery</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dirname</span><span class="o">=</span><span class="s1">&#39;./&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">,</span> <span class="n">saveFig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">showFig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Process and generate a figure using the classification method proposed by Urs</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="iwin.gxe.Nursery.processClassificationMethod_old" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">gxe</span><span class="o">.</span><span class="n">Nursery</span><span class="o">.</span><span class="n">processClassificationMethod_old</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nursery</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;LA&#39;</span><span class="p">,</span> <span class="s1">&#39;LB&#39;</span><span class="p">,</span> <span class="s1">&#39;HA&#39;</span><span class="p">,</span> <span class="s1">&#39;HB&#39;</span><span class="p">],</span> <span class="n">qd</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">dirname</span><span class="o">=</span><span class="s1">&#39;./&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">,</span> <span class="n">saveFig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">showFig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Classify nurseries by avg grain yield</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="iwin.gxe.Nursery.processClassificationMethod" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">gxe</span><span class="o">.</span><span class="n">Nursery</span><span class="o">.</span><span class="n">processClassificationMethod</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nursery</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;AL&#39;</span><span class="p">,</span> <span class="s1">&#39;BH&#39;</span><span class="p">,</span> <span class="s1">&#39;AH_A&#39;</span><span class="p">,</span> <span class="s1">&#39;AH_B&#39;</span><span class="p">,</span> <span class="s1">&#39;BL_A&#39;</span><span class="p">,</span> <span class="s1">&#39;BL_B&#39;</span><span class="p">],</span> <span class="n">qd</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">dirname</span><span class="o">=</span><span class="s1">&#39;./&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">,</span> <span class="n">plot_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">saveFig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">showFig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Classify nurseries by avg grain yield</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="iwin.gxe.Nursery.commonGIDsinMethods" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">gxe</span><span class="o">.</span><span class="n">Nursery</span><span class="o">.</span><span class="n">commonGIDsinMethods</span><span class="p">(</span><span class="n">df_raw</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">selGIDs_m3</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nursery</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">65</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.85</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">xt_tl</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">yt_tl</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">dirname</span><span class="o">=</span><span class="s1">&#39;./&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">,</span> <span class="n">showFig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">saveFig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Combine all of the methods applied to the genotypes selection</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="iwin.gxe.Nursery.commonGIDsinMethods_v2" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">gxe</span><span class="o">.</span><span class="n">Nursery</span><span class="o">.</span><span class="n">commonGIDsinMethods_v2</span><span class="p">(</span><span class="n">df_raw</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">selGIDs_m3</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nursery</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bothEnvs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">65</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.85</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">xt_tl</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">yt_tl</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">dirname</span><span class="o">=</span><span class="s1">&#39;./&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">,</span> <span class="n">showFig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">saveFig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Combine all of the methods applied to the genotypes selection</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="iwin.gxe.Nursery.prepareDatasetforGEmodel" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">gxe</span><span class="o">.</span><span class="n">Nursery</span><span class="o">.</span><span class="n">prepareDatasetforGEmodel</span><span class="p">(</span><span class="n">df_gen</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nursery</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Prepare data as an input for the GxE models</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="iwin.gxe.Nursery.GEmeans" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">gxe</span><span class="o">.</span><span class="n">Nursery</span><span class="o">.</span><span class="n">GEmeans</span><span class="p">(</span><span class="n">df_ge</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">trial</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">byCountry</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">showFig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">saveFig</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">square</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dirname</span><span class="o">=</span><span class="s1">&#39;./&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Display Genotype, Environment and Genotype-environment means</p>
<p>Genotype’s performance across environments shown in line plots and heatmaps
Spatial variations (Heat-maps) for all Genotypes all Environemnts</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="iwin.gxe.Nursery.ge_impute_missing_values" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">gxe</span><span class="o">.</span><span class="n">Nursery</span><span class="o">.</span><span class="n">ge_impute_missing_values</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">fillna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Select better environments and Genotypes along sites with no empty values. 
Remove environments or Genotypes with more than 50% or threshold value of empty data.
Fill the rest of the null values with the mean by Environment.</p>
<p>:params data: Table of Genotypes, Environments and GE means
:params threshold: Upper limit in percentage to remove emtpy Environments and Genotypes records</p>
<p>:results: A cleaner two-way table of means</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="iwin.gxe.Nursery.geAMMI" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">gxe</span><span class="o">.</span><span class="n">Nursery</span><span class="o">.</span><span class="n">geAMMI</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Gen</span><span class="o">=</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="n">Env</span><span class="o">=</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="n">trait</span><span class="o">=</span><span class="s1">&#39;GY&#39;</span><span class="p">,</span> <span class="n">trialname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">twt</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">fillna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">centering</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">scaling</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">n_components</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Additive Main Effect and Multiplicative interaction model</p>
<p>:params data: table with Genotypes, Environments and traits observations
:params twt: if the data is Two-way table of means, default False or in long format.</p>
<p>:returns: AMMI model</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="iwin.gxe.Nursery.geGGE" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">gxe</span><span class="o">.</span><span class="n">Nursery</span><span class="o">.</span><span class="n">geGGE</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">env</span><span class="o">=</span><span class="s1">&#39;ENV&#39;</span><span class="p">,</span> <span class="n">gen</span><span class="o">=</span><span class="s1">&#39;GEN&#39;</span><span class="p">,</span> <span class="n">trait</span><span class="o">=</span><span class="s1">&#39;GY&#39;</span><span class="p">,</span> <span class="n">trialname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">twt</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">impute_missing_threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Genotype plus Genotype-Environment interaction model</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="iwin.gxe.Nursery.gge_rankingG" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">gxe</span><span class="o">.</span><span class="n">Nursery</span><span class="o">.</span><span class="n">gge_rankingG</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">env</span><span class="o">=</span><span class="s1">&#39;ENV&#39;</span><span class="p">,</span> <span class="n">gen</span><span class="o">=</span><span class="s1">&#39;GEN&#39;</span><span class="p">,</span> <span class="n">trait</span><span class="o">=</span><span class="s1">&#39;GY&#39;</span><span class="p">,</span> <span class="n">impute_missing_threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">twt</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">plot_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">saveFig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">showFig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dirname</span><span class="o">=</span><span class="s1">&#39;./&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Ranking Genotypes Relative to the Ideal Genotype</p>
<p>An ideal genotype should have both high mean performance and high stability across environments.</p>
<p>This figure defines an “ideal” genotype (the center of the concentric circles) to be a point on the AEA 
(“absolutely stable”) in the positive direction and has a vector length equal to the longest vectors of 
the genotypes on the positive side of AEA (“highest mean performance”). Therefore, genotypes located closer 
to the ‘ideal genotype’ are more desirable than others.</p>
<p>This Figure illustrates an important concept regarding “stability”. The term “high stability” is meaningful 
only when associated with mean performance</p>
<p>Note: it should be easy to see how misleading it can be to search and select for “stability” genes. 
“Stable” genotypes are desirable only when they have high mean performances.</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="iwin.gxe.Nursery.gge_www" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">gxe</span><span class="o">.</span><span class="n">Nursery</span><span class="o">.</span><span class="n">gge_www</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">env</span><span class="o">=</span><span class="s1">&#39;ENV&#39;</span><span class="p">,</span> <span class="n">gen</span><span class="o">=</span><span class="s1">&#39;GEN&#39;</span><span class="p">,</span> <span class="n">trait</span><span class="o">=</span><span class="s1">&#39;GY&#39;</span><span class="p">,</span> <span class="n">impute_missing_threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">twt</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">plot_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">saveFig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">showFig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dirname</span><span class="o">=</span><span class="s1">&#39;./&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Which-won-where</p>
<p>One of the most attractive features of a GGE biplot is its ability to show the which-won-where pattern 
of a genotype by environment dataset. Many researchers find this use of a biplot intriguing, as it 
graphically addresses important concepts such as crossover GE, mega-environment differentiation, specific 
adaptation, etc.</p>
<p>Genotypes located on the vertices of the polygon performed either the best or the poorest in one or 
more environments.</p>
<ul>
<li>The perpendicular lines are equality lines between adjacent genotypes on the polygon, which 
  facilitate visual comparison of them.</li>
<li>The equality lines divide the biplot into sectors, and the winning genotype for each sector 
  is the one located on the respective vertex.</li>
<li>This pattern suggests that the target environment may consist of XXXX different mega-environments 
  and that different cultivars should be selected and deployed for each.</li>
</ul>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="iwin.gxe.Nursery.extract_Weather" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">gxe</span><span class="o">.</span><span class="n">Nursery</span><span class="o">.</span><span class="n">extract_Weather</span><span class="p">(</span><span class="n">df_raw</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">df_gen</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">df_weather</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Extract weather data from AgERA5 dataset for each location</p>
<p>Use 150 days after planting to define the growing season</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="iwin.gxe.Nursery.extract_Weather_growthStages" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">gxe</span><span class="o">.</span><span class="n">Nursery</span><span class="o">.</span><span class="n">extract_Weather_growthStages</span><span class="p">(</span><span class="n">df_raw</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">df_gen</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">df_weather</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Extract weather data from AgERA5 dataset for each location</p>
<p>Use 150 days after planting to define the growing season</p>

  </div>

</div>



  </div>

  </div>

</div>



<div class="doc doc-object doc-module">



<h3 id="iwin.gxe.ammi" class="doc doc-heading">
            <code>iwin.gxe.ammi</code>


</h3>

  <div class="doc doc-contents ">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h4 id="iwin.gxe.ammi.AMMI" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">gxe</span><span class="o">.</span><span class="n">ammi</span><span class="o">.</span><span class="n">AMMI</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">trait</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">trialname</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code>object</code></p>



  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h5 id="iwin.gxe.ammi.AMMI.cal_env_residuals" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">gxe</span><span class="o">.</span><span class="n">ammi</span><span class="o">.</span><span class="n">AMMI</span><span class="o">.</span><span class="n">cal_env_residuals</span><span class="p">()</span></code>

</h5>


  <div class="doc doc-contents ">
  
      <p>Cálculo de residuales con respecto a la media de los ambientes</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="iwin.gxe.ammi.AMMI.calc_gen_residuals" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">gxe</span><span class="o">.</span><span class="n">ammi</span><span class="o">.</span><span class="n">AMMI</span><span class="o">.</span><span class="n">calc_gen_residuals</span><span class="p">()</span></code>

</h5>


  <div class="doc doc-contents ">
  
      <p>Cálculo de residuales con respecto a la media de los genotipos</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="iwin.gxe.ammi.AMMI.plot" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">gxe</span><span class="o">.</span><span class="n">ammi</span><span class="o">.</span><span class="n">AMMI</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bptype</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">plot_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">saveFig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">showFig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dirname</span><span class="o">=</span><span class="s1">&#39;./&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">)</span></code>

</h5>


  <div class="doc doc-contents ">
  
      <p>Display biplot</p>

  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="iwin.gxe.gge" class="doc doc-heading">
            <code>iwin.gxe.gge</code>


</h3>

  <div class="doc doc-contents ">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h4 id="iwin.gxe.gge.GGE" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">gxe</span><span class="o">.</span><span class="n">gge</span><span class="o">.</span><span class="n">GGE</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">env</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">gen</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">trait</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">trialname</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">twt</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code>object</code></p>

  
      <p>Genotype plus Genotype-Environment interaction model</p>


  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h5 id="iwin.gxe.gge.GGE.best_G" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">gxe</span><span class="o">.</span><span class="n">gge</span><span class="o">.</span><span class="n">GGE</span><span class="o">.</span><span class="n">best_G</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h5>


  <div class="doc doc-contents ">
  
      <p>Select the best or nearest Genotype after GGE ranking Genotypes relative to the Ideal Genotype</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="iwin.gxe.gge.GGE.calc_env_residuals" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">gxe</span><span class="o">.</span><span class="n">gge</span><span class="o">.</span><span class="n">GGE</span><span class="o">.</span><span class="n">calc_env_residuals</span><span class="p">()</span></code>

</h5>


  <div class="doc doc-contents ">
  
      <p>Cálculo de residuales con respecto a la media de los ambientes</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="iwin.gxe.gge.GGE.calc_gen_residuals" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">gxe</span><span class="o">.</span><span class="n">gge</span><span class="o">.</span><span class="n">GGE</span><span class="o">.</span><span class="n">calc_gen_residuals</span><span class="p">()</span></code>

</h5>


  <div class="doc doc-contents ">
  
      <p>Cálculo de residuales con respecto a la media de los genotipos</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="iwin.gxe.gge.GGE.get_twoway_table" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">gxe</span><span class="o">.</span><span class="n">gge</span><span class="o">.</span><span class="n">GGE</span><span class="o">.</span><span class="n">get_twoway_table</span><span class="p">(</span><span class="n">impute_missing_threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">fillna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h5>


  <div class="doc doc-contents ">
  
      <p>Create two-way table of means</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="iwin.gxe.gge.GGE.impute_missing_values" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">gxe</span><span class="o">.</span><span class="n">gge</span><span class="o">.</span><span class="n">GGE</span><span class="o">.</span><span class="n">impute_missing_values</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">impute_missing_threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">fillna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h5>


  <div class="doc doc-contents ">
  
      <p>Select better environments and Genotypes along sites with no empty values. 
Remove environments or Genotypes with more than 50% or threshold value of empty data.
Fill the rest of the null values with the mean by Environment.</p>
<p>:params data: Table of Genotypes, Environments and GE means
:params impute_missing_threshold: Upper limit in percentage to remove empty Environments and Genotypes records</p>
<p>:results: A cleaner two-way table of means</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="iwin.gxe.gge.GGE.prepare_data" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">gxe</span><span class="o">.</span><span class="n">gge</span><span class="o">.</span><span class="n">GGE</span><span class="o">.</span><span class="n">prepare_data</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h5>


  <div class="doc doc-contents ">
  
      <p>Prepare data for GGE biplots</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="iwin.gxe.gge.GGE.getMegaEnvironments" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">gxe</span><span class="o">.</span><span class="n">gge</span><span class="o">.</span><span class="n">GGE</span><span class="o">.</span><span class="n">getMegaEnvironments</span><span class="p">(</span><span class="n">lim_span</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">mxlim</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h5>


  <div class="doc doc-contents ">
  
      <p>Get Mega-Environments using GGE biplot</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="iwin.gxe.gge.GGE.plot" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">gxe</span><span class="o">.</span><span class="n">gge</span><span class="o">.</span><span class="n">GGE</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bptype</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">selE</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">selG</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">plot_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">saveFig</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">showFig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dirname</span><span class="o">=</span><span class="s1">&#39;./&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">)</span></code>

</h5>


  <div class="doc doc-contents ">
  
      <p>Display biplot</p>

  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div>


  </div>

  </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="iwin.util" class="doc doc-heading">
            <code>iwin.util</code>


</h2>

  <div class="doc doc-contents ">

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="iwin.util.is_number" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">is_number</span><span class="p">(</span><span class="n">s</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Check if the string is a number</p>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>ValueError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Not a number.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.util.getDOY" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">getDOY</span><span class="p">(</span><span class="n">d</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get Day of the Year</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.util.find_nearest_value" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">find_nearest_value</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Find nearest value to a user define value from array</p>
<p>:params array: Array of values
:params value: value to find into the array</p>
<p>:return: a number with the nearest value found</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.util.find_nearest_index" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">find_nearest_index</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Find nearest index to a user define value from array</p>
<p>:params array: Array of values
:params values: value to find into the array</p>
<p>:return: a number with the nearest index found</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.util.find_nearest" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">find_nearest</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Find nearest index and value to a user define value from array</p>
<p>:params array: Array of values
:params value: value to find into the array</p>
<p>:return: a number with the nearest value found</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.util.getScores" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">getScores</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">fld1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fld2</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get stats for model results</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.util.getAccuracy" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">getAccuracy</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_predicted</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Calculate accuracy and precision for each year in a nursery site</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.util.missing_values_table" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">missing_values_table</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Look for missing values in a dataset</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.util.missingData" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">missingData</span><span class="p">(</span><span class="n">df_GE</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;IWIN GxE</span><span class="se">\n</span><span class="s1">Missing data&#39;</span><span class="p">,</span> <span class="n">dirname</span><span class="o">=</span><span class="s1">&#39;./&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">,</span> <span class="n">showFig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">saveFig</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Looking for missing values
Check for all the variables in an arrays or pandas DF and visualize the missing data</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.util.findNearest_point" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">findNearest_point</span><span class="p">(</span><span class="n">arr</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pnt</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Select the nearest point</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.util.getExtrapoledLine" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">getExtrapoledLine</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">EXTRAPOL_RATIO</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">rtn_coods</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Creates a line extrapoled in p1-&gt;p2 direction</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.util.custom_rolling" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">custom_rolling</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">op</span><span class="o">=</span><span class="s1">&#39;min&#39;</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Duplica el arreglo para completar todos las columnas 
con el numero de datos seleccionado para la ventana</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.util.assignME" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">assignME</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Mega-environments </p>
<p>Al momento solo ME4</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.util.normalize_Yield" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">normalize_Yield</span><span class="p">(</span><span class="n">yld</span><span class="p">,</span> <span class="n">perc</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Use 95th percentile of yield (top 5%) of each site-year as a reference and 
express the yield of each GID within a site-year in percent of the top yield.</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.util.tidy_corr_matrix" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">tidy_corr_matrix</span><span class="p">(</span><span class="n">corr_mat</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Función para convertir una matriz de correlación de pandas en formato tidy.</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.util.idenfifyTargetGIDs_byNurseryYear" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">idenfifyTargetGIDs_byNurseryYear</span><span class="p">(</span><span class="n">df_filtered</span><span class="p">,</span> <span class="n">nursery</span><span class="o">=</span><span class="s1">&#39;ESWYT&#39;</span><span class="p">,</span> <span class="n">path_to_save_results</span><span class="o">=</span><span class="s1">&#39;./&#39;</span><span class="p">,</span> <span class="n">drawFigures</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Extract the targeted GIDs from a pre-processed IWIN dataset</p>

<details class="classify-trials-in" open>
  <summary>Classify trials in</summary>
  <ul>
<li>Above Avg in Low Yielding Envs - Below Avg in High Yielding Envs</li>
<li>Below Avg in Low Yielding Envs - Above Avg in High Yielding Envs</li>
<li>Highest/Lowest norm. Yield GIDs</li>
<li>Above Avg. Low Temperature GIDs</li>
<li>Above Avg. High Temperature GIDs</li>
<li>Support or not warmer temperature</li>
<li>Warmest Environments</li>
</ul>
</details>      <p>Return 3 tables with linear model parameters</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.util.filterTargetGIDs_byThresholdMaxTemperature" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">filterTargetGIDs_byThresholdMaxTemperature</span><span class="p">(</span><span class="n">df_filtered</span><span class="p">,</span> <span class="n">GIDs_inTarget_highTemperature</span><span class="p">,</span> <span class="n">nursery</span><span class="o">=</span><span class="s1">&#39;ESWYT&#39;</span><span class="p">,</span> <span class="n">avgLT_threshold</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">avgHT_threshold</span><span class="o">=</span><span class="mf">30.0</span><span class="p">,</span> <span class="n">gt32C_ndays_threshold</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">path_to_save_results</span><span class="o">=</span><span class="s1">&#39;./&#39;</span><span class="p">,</span> <span class="n">saveFiles</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Filter target GIDs by Temperature using <code>Season_TMAX_mean</code> and <code>S-H_TMAX_gt32C_ndays</code> as references</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.util.displayMap_spatialDistSelectedGIDs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">displayMap_spatialDistSelectedGIDs</span><span class="p">(</span><span class="n">df_gids</span><span class="p">,</span> <span class="n">nursery</span><span class="o">=</span><span class="s1">&#39;ESWYT&#39;</span><span class="p">,</span> <span class="n">path_to_save_results</span><span class="o">=</span><span class="s1">&#39;./&#39;</span><span class="p">,</span> <span class="n">saveFig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Spatial distribution of selected IWIN genotypes</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.util.displayGenotypeSensitivitybyWeather" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">displayGenotypeSensitivitybyWeather</span><span class="p">(</span><span class="n">df_final</span><span class="p">,</span> <span class="n">gid</span><span class="p">,</span> <span class="n">yFld</span><span class="o">=</span><span class="s1">&#39;Grain Yield&#39;</span><span class="p">,</span> <span class="n">nursery</span><span class="o">=</span><span class="s1">&#39;ESWYT&#39;</span><span class="p">,</span> <span class="n">path_to_save_results</span><span class="o">=</span><span class="s1">&#39;./&#39;</span><span class="p">,</span> <span class="n">saveFig</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>The Eberhart and Russell regression with the grain yield environmental means along 
the x-axis replaced with a climate variable.</p>
<p>Genotypes differ in their sensitivity to climate variables</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.util.displayTempVsGY_inGrowStagesforAllGIDs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">displayTempVsGY_inGrowStagesforAllGIDs</span><span class="p">(</span><span class="n">df_filtered</span><span class="p">,</span> <span class="n">df_HT</span><span class="p">,</span> <span class="n">nursery</span><span class="o">=</span><span class="s1">&#39;ESWYT&#39;</span><span class="p">,</span> <span class="n">path_to_save_results</span><span class="o">=</span><span class="s1">&#39;./&#39;</span><span class="p">,</span> <span class="n">saveFig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Temperature vs Grain Yield in 3 growth stages (all GIDs)</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.util.drawTemperaturebyGrowthStage_acrossYears" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">drawTemperaturebyGrowthStage_acrossYears</span><span class="p">(</span><span class="n">df_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nursery</span><span class="o">=</span><span class="s1">&#39;NURSERY&#39;</span><span class="p">,</span> <span class="n">temp</span><span class="o">=</span><span class="s1">&#39;TMAX&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">bxplot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">dirname</span><span class="o">=</span><span class="s1">&#39;GrowthStages_Temperature&#39;</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="s1">&#39;TemperatureAcrossYrsxGrowthstage&#39;</span><span class="p">,</span> <span class="n">path_to_save_results</span><span class="o">=</span><span class="s1">&#39;./&#39;</span><span class="p">,</span> <span class="n">saveFig</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">showFig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Average daily temperature across years vs mean grain yield by GID</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.util.drawTemperaturebyGrowthStage_acrossYears_v2" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">drawTemperaturebyGrowthStage_acrossYears_v2</span><span class="p">(</span><span class="n">df_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nursery</span><span class="o">=</span><span class="s1">&#39;NURSERY&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">bxplot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">dirname</span><span class="o">=</span><span class="s1">&#39;GrowthStages_Temperature&#39;</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="s1">&#39;TemperatureAcrossYrsxGrowthstage_v2&#39;</span><span class="p">,</span> <span class="n">path_to_save_results</span><span class="o">=</span><span class="s1">&#39;./&#39;</span><span class="p">,</span> <span class="n">saveFig</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">showFig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Average daily temperature across years vs mean grain yield by GID</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.util.drawRegCoefficientbyGrowthStage_acrossYears" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">drawRegCoefficientbyGrowthStage_acrossYears</span><span class="p">(</span><span class="n">df_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nursery</span><span class="o">=</span><span class="s1">&#39;NURSERY&#39;</span><span class="p">,</span> <span class="n">splitYear</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">trendVar</span><span class="o">=</span><span class="s1">&#39;Temperature&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">bxplot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">dirname</span><span class="o">=</span><span class="s1">&#39;GrowthStages_Temperature&#39;</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="s1">&#39;TemperatureAcrossYrsxGrowthstage_v3&#39;</span><span class="p">,</span> <span class="n">path_to_save_results</span><span class="o">=</span><span class="s1">&#39;./&#39;</span><span class="p">,</span> <span class="n">saveFig</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">showFig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Average daily temperature across years vs mean grain yield by GID</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.util.drawCompareGYvsTMAXbyGS" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">drawCompareGYvsTMAXbyGS</span><span class="p">(</span><span class="n">df_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">GIDs2compare</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nursery</span><span class="o">=</span><span class="s1">&#39;NURSERY&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.65</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.25</span><span class="p">,</span> <span class="n">dirname</span><span class="o">=</span><span class="s1">&#39;GrowthStages_Temperature&#39;</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="s1">&#39;CompareGYvsTMAXbyGS&#39;</span><span class="p">,</span> <span class="n">path_to_save_results</span><span class="o">=</span><span class="s1">&#39;./&#39;</span><span class="p">,</span> <span class="n">saveFig</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">showFig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Comparison of Genotypes vs Maximum Temperature by growth stage
display the average daily temperature across years vs mean grain yield by selected GID</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.util.ranking_selectedGenotypes" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">ranking_selectedGenotypes</span><span class="p">(</span><span class="n">df_final</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Ranking Selected Genotypes</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.util.getVarietyCounts" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">getVarietyCounts</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Count the number of site-year trials using a cultivar</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.util.searchParenLines" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">searchParenLines</span><span class="p">(</span><span class="n">df_raw</span><span class="p">,</span> <span class="n">df_GY_sorted</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Identifying parents lines</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.util.seachWheatLinesInExtremeWeather" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">seachWheatLinesInExtremeWeather</span><span class="p">(</span><span class="n">df_raw</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="s1">&#39;ESWYT&#39;</span><span class="p">,</span> <span class="n">AVGHT_THRESHOLD</span><span class="o">=</span><span class="mf">30.0</span><span class="p">,</span> <span class="n">GT32C_NDAYS_THRESHOLD</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">splitYear</span><span class="o">=</span><span class="mi">2005</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">path_to_save_results</span><span class="o">=</span><span class="s1">&#39;./&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">drawFigures</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">showFig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Run all processes in one step to identify best pedigrees in low yielding environments and extreme weather.</p>

  </div>

</div>


<div class="doc doc-object doc-module">



<h3 id="iwin.util.figures" class="doc doc-heading">
            <code>iwin.util.figures</code>


</h3>

  <div class="doc doc-contents ">

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h4 id="iwin.util.figures.chart_compareResults" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">figures</span><span class="o">.</span><span class="n">chart_compareResults</span><span class="p">(</span><span class="n">df_result</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fld1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fld2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">xy_lim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">loc_leg</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">dirname</span><span class="o">=</span><span class="s1">&#39;RUNS&#39;</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="s1">&#39;iPAR_model_&#39;</span><span class="p">,</span> <span class="n">dispScore</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dispLegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">saveFig</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">showFig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Display a scatter plot to compare two variables in the results</p>
<h6 id="iwin.util.figures.chart_compareResults--parameters">Parameters</h6>
<p>:params df_result: A pandas DataFrame with the results and variables to compare
:params fld1: Variable or column name to compare
:params fld2: Variable or column name to compare
:params alpha: Transparency of the points in chart
:params s: Size of the points in chart
:params xy_lim: Used to extend the x-axis limit. Default 2 units
:params hue: Variable to classify or discriminate the results in colors
:params title: Title of the figure
:params xlabel: Label of the x-axis
:params ylabel: Label of the y-axis
:params dirname: Folder name to save results
:params fname: File name to save the figure
:params dispScore: Display the accurracy and others stats of the model
:params dispLegend: Display the legend of the chart
:params saveFig: Save file in JPG or PDF format
:params fmt: Format of the output</p>
<h6 id="iwin.util.figures.chart_compareResults--returns">Returns</h6>
<p>:results: A figure in JPG or PDF format with the filename specified into the folder name</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="iwin.util.figures.chart_compareYieldResults" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">figures</span><span class="o">.</span><span class="n">chart_compareYieldResults</span><span class="p">(</span><span class="n">df_result</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;iPAR Yield model&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">xy_lim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;country&#39;</span><span class="p">,</span> <span class="n">loc_leg</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">xt_tl</span><span class="o">=</span><span class="mf">0.03</span><span class="p">,</span> <span class="n">yt_tl</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">dirname</span><span class="o">=</span><span class="s1">&#39;Figures&#39;</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="s1">&#39;Figure&#39;</span><span class="p">,</span> <span class="n">dispScore</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">saveFig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">showFig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Create a figure to compare several iPAR model simulations results of grain yield</p>
<p>:params df_result: A table or DataFrame with the needed data
:params title: Name of the figure
:params alpha: Transparency of the points in chart
:params s: Size of the points in chart
:params xy_lim: Used to extend the x-axis limit. Default 2 units
:params hue: Variable to classify or discriminate the results in colors
:params ncol: Number of columns to split the legend
:params dirname: Folder name to save results
:params fname: File name to save the figure
:params saveFig: Save file or export the figure
:params sharex: Share or align all x-axis, it will use the same x scale for all charts if the value is True
:params sharey: Share or align all y-axis, it will use the same y scale for all charts if the value is True
:params fmt: Format of the output (PNG, JPG or PDF)</p>
<p>:results: An integrated figure with 4 charts showing result simulations</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="iwin.util.figures.chart_compareDaysFromStagesResults" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">figures</span><span class="o">.</span><span class="n">chart_compareDaysFromStagesResults</span><span class="p">(</span><span class="n">df_result</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;iPAR Yield model&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">xy_lim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;loc_code&#39;</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">xt_tl</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">yt_tl</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">dirname</span><span class="o">=</span><span class="s1">&#39;Figures&#39;</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="s1">&#39;Figure&#39;</span><span class="p">,</span> <span class="n">dispScore</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">saveFig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">showFig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Create a figure to compare several iPAR model simulations results of grain yield</p>
<p>:params df_result: A table or DataFrame with the needed data
:params title: Name of the figure
:params alpha: Transparency of the points in chart
:params s: Size of the points in chart
:params xy_lim: Used to extend the x-axis limit. Default 2 units
:params hue: Variable to classify or discriminate the results in colors
:params ncol: Number of columns to split the legend
:params dirname: Folder name to save results
:params fname: File name to save the figure
:params saveFig: Save file or export the figure
:params sharex: Share or align all x-axis, it will use the same x scale for all charts if the value is True
:params sharey: Share or align all y-axis, it will use the same y scale for all charts if the value is True
:params fmt: Format of the output (PNG, JPG or PDF)</p>
<p>:results: An integrated figure with 4 simulation charts</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="iwin.util.figures.chartObsYieldTrendsAllNurseries" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">figures</span><span class="o">.</span><span class="n">chartObsYieldTrendsAllNurseries</span><span class="p">(</span><span class="n">df_N</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Observed yield trend&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">addMaxMinTexts</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">saveFig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">showFig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dirname</span><span class="o">=</span><span class="s1">&#39;./&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <div class="highlight"><pre><span></span><code>Display a grain yield trends by year
</code></pre></div>
<p>:params saveFig: Save file in JPG or PDF format
:params fmt: Format of the output</p>
<p>:results: A figure in JPG or PDF format with the filename specified into the folder name</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="iwin.util.figures.chartAvgObsYieldTrendsAllNurseries" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">figures</span><span class="o">.</span><span class="n">chartAvgObsYieldTrendsAllNurseries</span><span class="p">(</span><span class="n">df_N</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Average observed yield trends&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.83</span><span class="p">,</span> <span class="n">saveFig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">showFig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dirname</span><span class="o">=</span><span class="s1">&#39;./&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <div class="highlight"><pre><span></span><code>Display average grain yield trends by year
</code></pre></div>
<p>:params saveFig: Save file in JPG or PDF format
:params fmt: Format of the output</p>
<p>:results: A figure in JPG or PDF format with the filename specified into the folder name</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="iwin.util.figures.figure_AvgYieldbyGID_LR" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">figures</span><span class="o">.</span><span class="n">figure_AvgYieldbyGID_LR</span><span class="p">(</span><span class="n">avgGY_1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nursery</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="n">hue2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hue3</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hue4</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">s4</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.45</span><span class="p">,</span> <span class="n">alpha2</span><span class="o">=</span><span class="mf">0.85</span><span class="p">,</span> <span class="n">alpha4</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">xt_tl</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">yt_tl</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;OLS&#39;</span><span class="p">,</span> <span class="s1">&#39;RANSAC&#39;</span><span class="p">],</span> <span class="n">fld1</span><span class="o">=</span><span class="s1">&#39;AvGYxLocOcc&#39;</span><span class="p">,</span> <span class="n">fld2</span><span class="o">=</span><span class="s1">&#39;AvGYxGID&#39;</span><span class="p">,</span> <span class="n">saveFig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">showFig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dirname</span><span class="o">=</span><span class="s1">&#39;./&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Display a figure with regression lines applied for GIDs</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="iwin.util.figures.figure_AvgYieldbyGID_classify" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">figures</span><span class="o">.</span><span class="n">figure_AvgYieldbyGID_classify</span><span class="p">(</span><span class="n">avgGY_1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">avgGY_2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">df_countOfGIDs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">topGinBEnv</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">topGinGEnv</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nursery</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="n">hue2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hue3</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hue4</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">s4</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.45</span><span class="p">,</span> <span class="n">alpha2</span><span class="o">=</span><span class="mf">0.85</span><span class="p">,</span> <span class="n">alpha4</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">xt_tl</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">yt_tl</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">fld1</span><span class="o">=</span><span class="s1">&#39;AvGYxGID&#39;</span><span class="p">,</span> <span class="n">fld2</span><span class="o">=</span><span class="s1">&#39;AvGYxLocOcc&#39;</span><span class="p">,</span> <span class="n">dispTxt</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">saveFig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">showFig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dirname</span><span class="o">=</span><span class="s1">&#39;./&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Display a figure with regression lines applied for GIDs</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="iwin.util.figures.figure_AvgYieldbyGID_classify_v2" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">figures</span><span class="o">.</span><span class="n">figure_AvgYieldbyGID_classify_v2</span><span class="p">(</span><span class="n">avgGY_1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">avgGY_2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">df_countOfGIDs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">topGinBEnv</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">topBinGEnv</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nursery</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="n">hue2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hue3</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hue4</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">s4</span><span class="o">=</span><span class="mi">35</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.45</span><span class="p">,</span> <span class="n">alpha2</span><span class="o">=</span><span class="mf">0.85</span><span class="p">,</span> <span class="n">alpha4</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">xt_tl</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">yt_tl</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">fld1</span><span class="o">=</span><span class="s1">&#39; AvGYxGID&#39;</span><span class="p">,</span> <span class="n">fld2</span><span class="o">=</span><span class="s1">&#39;AvGYxLocOcc&#39;</span><span class="p">,</span> <span class="n">dispTxt</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">saveFig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">showFig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dirname</span><span class="o">=</span><span class="s1">&#39;./&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Display a figure with regression lines applied for GIDs</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="iwin.util.figures.plot_AvgYieldbyGID_classify" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">figures</span><span class="o">.</span><span class="n">plot_AvgYieldbyGID_classify</span><span class="p">(</span><span class="n">avgGY_1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">selGIDs_m3</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">numGIDsOfOcurrences</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nursery</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ptype</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">qd</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="p">[],</span> <span class="n">plot_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">saveFig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">showFig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dirname</span><span class="o">=</span><span class="s1">&#39;./&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;jpg&#39;</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Display figures with classification results by linear regression and clustering lines</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="iwin.util.figures.figure_AvgYieldbyGID_combineMethods" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">figures</span><span class="o">.</span><span class="n">figure_AvgYieldbyGID_combineMethods</span><span class="p">(</span><span class="n">df_GY</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fld1</span><span class="o">=</span><span class="s1">&#39;AvGYxLocOcc&#39;</span><span class="p">,</span> <span class="n">fld2</span><span class="o">=</span><span class="s1">&#39;AvGYxGID&#39;</span><span class="p">,</span> <span class="n">nursery</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.85</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">xt_tl</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">yt_tl</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">showFig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">saveFig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dirname</span><span class="o">=</span><span class="s1">&#39;./&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Display a figure with all combined methods</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="iwin.util.figures.clusterYieldEnvironments" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">figures</span><span class="o">.</span><span class="n">clusterYieldEnvironments</span><span class="p">(</span><span class="n">df_selGen</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nurseryGroup</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ESWYT&#39;</span><span class="p">],</span> <span class="n">fld1</span><span class="o">=</span><span class="s1">&#39;AvGYxLocOcc&#39;</span><span class="p">,</span> <span class="n">fld2</span><span class="o">=</span><span class="s1">&#39;AvGYxGID&#39;</span><span class="p">,</span> <span class="n">dispText</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.65</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;YieldEnv&#39;</span><span class="p">,</span> <span class="n">xy_lim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">xt_tl</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">yt_tl</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">saveFig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">showFig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">oneFigure</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">dirname</span><span class="o">=</span><span class="s1">&#39;./&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Display clusters of Yield environments</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="iwin.util.figures.chartObsYieldTrends" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">figures</span><span class="o">.</span><span class="n">chartObsYieldTrends</span><span class="p">(</span><span class="n">df_GY</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">selGIDs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ngrp</span><span class="o">=</span><span class="s1">&#39;ESWYT&#39;</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Observed yield trends&#39;</span><span class="p">,</span> <span class="n">sx_min</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sy_min</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">sx_max</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sy_max</span><span class="o">=</span><span class="mf">0.03</span><span class="p">,</span> <span class="n">addMaxMinTexts</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">saveFig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">showFig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dirname</span><span class="o">=</span><span class="s1">&#39;./&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Display Observed Yield Trends</p>

  </div>

</div>



  </div>

  </div>

</div>


  </div>

  </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="iwin.stats" class="doc doc-heading">
            <code>iwin.stats</code>


</h2>

  <div class="doc doc-contents ">

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="iwin.stats.prepareDatasetforR" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">prepareDatasetforR</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">folder</span><span class="o">=</span><span class="s1">&#39;GxE&#39;</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Prepare the IWIN dataset in a specific format for analysis in R statistical packages</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.stats.joinBLUPnBLUE_andNormilizedYield_GrpByGID" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">joinBLUPnBLUE_andNormilizedYield_GrpByGID</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">BLU</span><span class="p">,</span> <span class="n">stats</span><span class="p">,</span> <span class="n">nursery</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">saveFile</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Join BLUP and BLUE values, and Normalize Yield</p>
<p>It uses 95th percentile of yield (top 5%) of each site-year as a reference and express the yield 
of each GID within a site-year in percent of the top yield.</p>
<p>Return a group by GID table</p>

  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="iwin.iparyield" class="doc doc-heading">
            <code>iwin.iparyield</code>


</h2>

  <div class="doc doc-contents ">

  

  <div class="doc doc-children">










<div class="doc doc-object doc-module">



<h3 id="iwin.iparyield.model" class="doc doc-heading">
            <code>iwin.iparyield.model</code>


</h3>

  <div class="doc doc-contents ">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h4 id="iwin.iparyield.model.iPARModel" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">iparyield</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">iPARModel</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">parameters</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code>object</code></p>



  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h5 id="iwin.iparyield.model.iPARModel.load_raw_datasets" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">iparyield</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">iPARModel</span><span class="o">.</span><span class="n">load_raw_datasets</span><span class="p">()</span></code>

</h5>


  <div class="doc doc-contents ">
  
      <p>Load raw IWIN and AgERA5 datasets</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="iwin.iparyield.model.iPARModel.load_datasets" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">iparyield</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">iPARModel</span><span class="o">.</span><span class="n">load_datasets</span><span class="p">()</span></code>

</h5>


  <div class="doc doc-contents ">
  
      <p>Load IWIN and AgERA5 datasets in parquet format
    Reading the Parquet format is much more efficient.</p>
<p>:return: Two dataframes for crop phenology and weather dataset respectively.</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="iwin.iparyield.model.iPARModel.filterPhenologyData" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">iparyield</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">iPARModel</span><span class="o">.</span><span class="n">filterPhenologyData</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fld</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">selcols</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h5>


  <div class="doc doc-contents ">
  
      <p>Filter dataset by Nursery</p>
<p>:params data: A table or DF with trial for each site</p>
<p>:results: An array or DF of filtered sites</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="iwin.iparyield.model.iPARModel.prepareData" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">iparyield</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">iPARModel</span><span class="o">.</span><span class="n">prepareData</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">selcols</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h5>


  <div class="doc doc-contents ">
  
      <p>Preprocessing dataset to the iPAR yield formats</p>
<p>:params data: A table or DF with phenology for each site
:params params: Paramaters used to control the phenology simulation
:params selcols: Attibutes or columns selected to use in the simulations</p>
<p>:results: An array of sites with info setup for run model</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="iwin.iparyield.model.iPARModel.prepareData_toExtractWeather" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">iparyield</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">iPARModel</span><span class="o">.</span><span class="n">prepareData_toExtractWeather</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">selcols</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h5>


  <div class="doc doc-contents ">
  
      <p>Preprocessing dataset to extract weather data in parallel</p>
<p>:params data: A table or DF with phenology for each site
:params selcols: Attibutes or columns selected to use in the simulations</p>
<p>:results: An array of sites with info setup for run model</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="iwin.iparyield.model.iPARModel.process_ClimateStatsforGrowthStage" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">iparyield</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">iPARModel</span><span class="o">.</span><span class="n">process_ClimateStatsforGrowthStage</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">weather</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h5>


  <div class="doc doc-contents ">
  
      <p>Distill the climate data down into meaningful variables.
Extract weather data from AgERA5 dataset for each location in each growth stage</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="iwin.iparyield.model.iPARModel.process_ClimateStatsforGrowthPeriod_v3" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">iparyield</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">iPARModel</span><span class="o">.</span><span class="n">process_ClimateStatsforGrowthPeriod_v3</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">weather</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">climatevars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;TMIN&#39;</span><span class="p">,</span> <span class="s1">&#39;TAVG&#39;</span><span class="p">,</span> <span class="s1">&#39;TMAX&#39;</span><span class="p">,</span> <span class="s1">&#39;PCP&#39;</span><span class="p">,</span> <span class="s1">&#39;SolRad&#39;</span><span class="p">,</span> <span class="s1">&#39;RHUMn&#39;</span><span class="p">,</span> <span class="s1">&#39;RHUMx&#39;</span><span class="p">,</span> <span class="s1">&#39;WIND&#39;</span><span class="p">,</span> <span class="s1">&#39;TDay&#39;</span><span class="p">,</span> <span class="s1">&#39;PTQ&#39;</span><span class="p">,</span> <span class="s1">&#39;iPAR_PRFT&#39;</span><span class="p">],</span> <span class="n">stats</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="s1">&#39;sd&#39;</span><span class="p">],</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h5>


  <div class="doc doc-contents ">
  
      <p>Distill the climate data down into meaningful variables.
Extract weather data from AgERA5 dataset for each location in each growth stage</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="iwin.iparyield.model.iPARModel.process_GapFillingforPhenology" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">iparyield</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">iPARModel</span><span class="o">.</span><span class="n">process_GapFillingforPhenology</span><span class="p">(</span><span class="n">sites_to_run</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">climate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h5>


  <div class="doc doc-contents ">
  
      <p>Filling gaps for phenology dates using algorithms developed by Urs</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="iwin.iparyield.model.iPARModel.process_GapFillingforPhenology_v3" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">iparyield</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">iPARModel</span><span class="o">.</span><span class="n">process_GapFillingforPhenology_v3</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">climate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h5>


  <div class="doc doc-contents ">
  
      <p>Filling gaps for phenology dates using algorithms developed by Urs</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="iwin.iparyield.model.iPARModel.fit" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">iparyield</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">iPARModel</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">sites_to_run</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">season</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h5>


  <div class="doc doc-contents ">
  
      <div class="highlight"><pre><span></span><code>Run an iPAR Yield model to fit yield
</code></pre></div>
<p>:params sites_to_run: Array of Site objects
:params season: Display weather statistics for different periods</p>
<p>:resutls: An array of sites with intermediate results</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="iwin.iparyield.model.iPARModel.runModel" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">iparyield</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">iPARModel</span><span class="o">.</span><span class="n">runModel</span><span class="p">(</span><span class="n">sites_to_run</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">season</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h5>


  <div class="doc doc-contents ">
  
      <div class="highlight"><pre><span></span><code>Run an iPAR Yield model to fit yield in Parallel
</code></pre></div>
<p>:params sites_to_run: Array of Site objects
:params season: Display weather statistics for different periods</p>
<p>:resutls: An array of sites with intermediate results</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="iwin.iparyield.model.iPARModel.extractClimatexBestPedigreeSelection" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">iparyield</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">iPARModel</span><span class="o">.</span><span class="n">extractClimatexBestPedigreeSelection</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">sites_to_run</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">batch_start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">batch_end</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">climate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;parquet&#39;</span><span class="p">,</span> <span class="n">saveFile</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h5>


  <div class="doc doc-contents ">
  
      <p>Estimate phenology using Urs' iPAR model and extract weather parameters in Parallel</p>
<p>:params sites_to_run: Array of Site objects</p>
<p>:resutls: An array of sites with intermediate results</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="iwin.iparyield.model.iPARModel.estimateWeatherPhenology_byObs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">iparyield</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">iPARModel</span><span class="o">.</span><span class="n">estimateWeatherPhenology_byObs</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">sites_to_run</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">climate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">saveIntermediateFiles</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">saveFile</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">vb</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h5>


  <div class="doc doc-contents ">
  
      <p>Estimate phenology using Urs' iPAR model and extract weather parameters for each observation, running in Parallel</p>

  </div>

</div>



  </div>

  </div>

</div>



<div class="doc doc-object doc-module">



<h4 id="iwin.iparyield.model.tadjday" class="doc doc-heading">
            <code>iwin.iparyield.model.tadjday</code>


</h4>

  <div class="doc doc-contents ">

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h5 id="iwin.iparyield.model.tadjday.calcTAdjDay" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">iparyield</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">tadjday</span><span class="o">.</span><span class="n">calcTAdjDay</span><span class="p">(</span><span class="n">Tavg</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">140</span><span class="p">,</span> <span class="n">rate</span><span class="o">=-</span><span class="mf">0.055</span><span class="p">)</span></code>

</h5>


  <div class="doc doc-contents ">
  
      <p>Calculate daily progress (Adjusted TDays). Depreciated: 20230127</p>
<p>:param Tavg: Number or array of Average Temperatures
:param threshold: Number of TDays. eg. IWIN: 42, Dhillon: 35, South Asia: 41</p>
<p>:return: a number or array of adjusted temperature days</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="iwin.iparyield.model.tadjday.getTAdjDay" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">iparyield</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">tadjday</span><span class="o">.</span><span class="n">getTAdjDay</span><span class="p">(</span><span class="n">Tavg</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">140</span><span class="p">,</span> <span class="n">rate</span><span class="o">=-</span><span class="mf">0.055</span><span class="p">)</span></code>

</h5>


  <div class="doc doc-contents ">
  
      <p>Calculate daily progress (Adjusted TDays)</p>
<p>:param Tavg: Number or array of Average Temperatures
:param threshold: Number of TDays. eg. IWIN: 42, Dhillon: 35, South Asia: 41</p>

<details class="modified-jan-27-2023" open>
  <summary>The algorithm tends to overestimate the short and</summary>
  <p>underestimate the long grainfilling durations.
y=165* exp(-0.07 * TAverage)</p>
</details>      <p>Modified Aug-16-2023: </p>
<p>:return: a number or array of adjusted temperature days</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="iwin.iparyield.model.tadjday.apply_TAdjDay" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">iparyield</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">tadjday</span><span class="o">.</span><span class="n">apply_TAdjDay</span><span class="p">(</span><span class="n">Tavg</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">140</span><span class="p">,</span> <span class="n">rate</span><span class="o">=-</span><span class="mf">0.055</span><span class="p">)</span></code>

</h5>


  <div class="doc doc-contents ">
  
      <p>Calculate daily progress (Adjusted TDays)</p>
<p>:param Tavg: Number or array of Average Temperatures
:param threshold: Number of TDays. eg. IWIN: 42, Dhillon: 35, South Asia: 41</p>
<p>:return: a number or array of adjusted temperature days</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="iwin.iparyield.model.tadjday.estimate_TAdjDay" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">iparyield</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">tadjday</span><span class="o">.</span><span class="n">estimate_TAdjDay</span><span class="p">(</span><span class="n">Tavg</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">140</span><span class="p">,</span> <span class="n">rate</span><span class="o">=-</span><span class="mf">0.055</span><span class="p">)</span></code>

</h5>


  <div class="doc doc-contents ">
  
      <p>Calculate daily progress (Adjusted TDays)</p>
<p>:param Tavg: Number or array of Average Temperatures
:param threshold: Number of TDays. eg. IWIN: 45, Dhillon: 35, South Asia: 41</p>
<p>:return: a number or array of adjusted temperature days</p>

  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">



<h4 id="iwin.iparyield.model.gdd" class="doc doc-heading">
            <code>iwin.iparyield.model.gdd</code>


</h4>

  <div class="doc doc-contents ">

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h5 id="iwin.iparyield.model.gdd.calcGDD" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">iparyield</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">gdd</span><span class="o">.</span><span class="n">calcGDD</span><span class="p">(</span><span class="n">Tmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Tmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Tbase</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

</h5>


  <div class="doc doc-contents ">
  
      <p>Growing degree days GDD (°F or °C)
    Calculated from: ((Daily Max Temp + Daily Min Temp)/2) - 32 °F (or 
    ((Daily Max Temp + Daily Min Temp)/2)).</p>
<p>:param Tmin: Number or array of Minimum Temperatures
:param Tmax: Number or array of Maximum Temperatures
:param Tbase: Temperature base of the crop</p>
<p>:return: a number or array of Growing degree days (GDD)</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="iwin.iparyield.model.gdd.getGDD" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">iparyield</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">gdd</span><span class="o">.</span><span class="n">getGDD</span><span class="p">(</span><span class="n">Tmin</span><span class="p">,</span> <span class="n">Tmax</span><span class="p">,</span> <span class="n">Tbase</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

</h5>


  <div class="doc doc-contents ">
  
      <p>Growing degree days GDD (°F or °C)
    Calculated from: ((Daily Max Temp + Daily Min Temp)/2) - 32 °F (or 
    ((Daily Max Temp + Daily Min Temp)/2)).</p>
<p>:param Tmin: Number or array of Minimum Temperatures
:param Tmax: Number or array of Maximum Temperatures
:param Tbase: Temperature base of the crop</p>
<p>:return: a number or array of Growing degree days (GDD)</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="iwin.iparyield.model.gdd.apply_GDD" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">iparyield</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">gdd</span><span class="o">.</span><span class="n">apply_GDD</span><span class="p">(</span><span class="n">Tmin</span><span class="p">,</span> <span class="n">Tmax</span><span class="p">,</span> <span class="n">Tbase</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

</h5>


  <div class="doc doc-contents ">
  
      <p>Growing degree days GDD (°F or °C)
    Calculated from: ((Daily Max Temp + Daily Min Temp)/2) - 32 °F (or 
    ((Daily Max Temp + Daily Min Temp)/2)).</p>
<p>:param Tmin: Number or array of Minimum Temperatures
:param Tmax: Number or array of Maximum Temperatures
:param Tbase: Temperature base of the crop</p>
<p>:return: a number or array of Growing degree days (GDD)</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="iwin.iparyield.model.gdd.calculateGDD" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">iparyield</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">gdd</span><span class="o">.</span><span class="n">calculateGDD</span><span class="p">(</span><span class="n">Tmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Tmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Tbase</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

</h5>


  <div class="doc doc-contents ">
  
      <p>Growing degree days GDD (°F or °C)
    Calculated from: ((Daily Max Temp + Daily Min Temp)/2) - 32 °F (or 
    ((Daily Max Temp + Daily Min Temp)/2)).</p>
<p>:param Tmin: Number or array of Minimum Temperatures
:param Tmax: Number or array of Maximum Temperatures
:param Tbase: Temperature base of the crop</p>
<p>:return: a number or array of Growing degree days (GDD)</p>

  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">



<h4 id="iwin.iparyield.model.prft" class="doc doc-heading">
            <code>iwin.iparyield.model.prft</code>


</h4>

  <div class="doc doc-contents ">

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h5 id="iwin.iparyield.model.prft.calcPRFT" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">iparyield</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">prft</span><span class="o">.</span><span class="n">calcPRFT</span><span class="p">(</span><span class="n">TDay</span><span class="p">,</span> <span class="n">TOpt</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span></code>

</h5>


  <div class="doc doc-contents ">
  
      <p>Estimate Photosynthesis reduction factor (PRFT)
    PRFT = 1 – 0.0025 * (TDay – TOpt)^2</p>
<p>:param TDay: Number or array of Day Temperatures
:param TOpt: Optimum Temperature</p>
<p>:return: a number or array of PRFT</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="iwin.iparyield.model.prft.apply_PRFT" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">iparyield</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">prft</span><span class="o">.</span><span class="n">apply_PRFT</span><span class="p">(</span><span class="n">Tday</span><span class="p">,</span> <span class="n">Topt</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span></code>

</h5>


  <div class="doc doc-contents ">
  
      <p>Estimate Photosynthesis reduction factor (PRFT)
    PRFT = 1 – 0.0025 * (TDay – TOpt)^2</p>
<p>:param TDay: Number or array of Day Temperatures
:param TOpt: Optimum Temperature</p>
<p>:return: a number or array of PRFT</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="iwin.iparyield.model.prft.calculatePRFT" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">iparyield</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">prft</span><span class="o">.</span><span class="n">calculatePRFT</span><span class="p">(</span><span class="n">Tday</span><span class="p">,</span> <span class="n">Topt</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span></code>

</h5>


  <div class="doc doc-contents ">
  
      <p>Estimate Photosynthesis reduction factor (PRFT)
    PRFT = 1 – 0.0025 * (TDay – TOpt)^2</p>
<p>:param TDay: Number or array of Day Temperatures
:param TOpt: Optimum Temperature</p>
<p>:return: a number or array of PRFT</p>

  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">



<h4 id="iwin.iparyield.model.ipar" class="doc doc-heading">
            <code>iwin.iparyield.model.ipar</code>


</h4>

  <div class="doc doc-contents ">

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h5 id="iwin.iparyield.model.ipar.calcIPAR" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">iparyield</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">ipar</span><span class="o">.</span><span class="n">calcIPAR</span><span class="p">(</span><span class="n">Norm_TT_EH</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Norm_SimNDVI_EH</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Norm_SimNDVI_HM</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">norm_iPAR_EH_bounds</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">NDVI_constantIPAR</span><span class="o">=</span><span class="mf">0.19</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h5>


  <div class="doc doc-contents ">
  
      <p>Total light interception - iPAR</p>
<h6 id="iwin.iparyield.model.ipar.calcIPAR--asrar-g-fuchs-m-kanemasu-et-hatfield-jl-1984">** Asrar, G., Fuchs, M., Kanemasu, E.T., Hatfield, J.L., 1984.</h6>
<h6 id="iwin.iparyield.model.ipar.calcIPAR--estimating-absorbed-photosynthetic-radiation-and-leaf-area-index-from-spectral-reflectance">Estimating absorbed photosynthetic radiation and leaf area index from spectral reflectance</h6>
<h6 id="iwin.iparyield.model.ipar.calcIPAR--in-wheat-agron-j-76-300306">in wheat. Agron. J. 76, 300–306.</h6>
<h6 id="iwin.iparyield.model.ipar.calcIPAR---campos-2018-remote-sensing-based-crop-biomass-with-water-or-light-driven-crop-growth-models-in">- Campos 2018 Remote sensing-based crop biomass with water or light-driven crop growth models in</h6>
<h6 id="iwin.iparyield.model.ipar.calcIPAR--wheat-commercial-fields">wheat commercial fields</h6>
<p>iPAR = NDVI * 1.25 - 0.19 # between heading and maturity (Campos et al. 2018)
iPAR = NDVI * 1.25 - 0.21 Daughtry et al. (1992)</p>
<hr />
<p>:params Norm_TT_EH: 
:params Norm_SimNDVI_EH: 
:params Norm_SimNDVI_HM: 
:params norm_iPAR_EH_bounds: Bounds for iPAR multi-linear equations</p>
<p>:return: An array of Total light interception values</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="iwin.iparyield.model.ipar.getIPAR_EH" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">iparyield</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">ipar</span><span class="o">.</span><span class="n">getIPAR_EH</span><span class="p">(</span><span class="n">Norm_TT_EH</span><span class="p">,</span> <span class="n">norm_iPAR_EH_bounds</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span></code>

</h5>


  <div class="doc doc-contents ">
  
      <p>Calculate daily progress (Adjusted TDays)</p>
<p>:param Tavg: Number or array of Average Temperatures
:param threshold: Number of TDays. eg. IWIN: 42, Dhillon: 35, South Asia: 41</p>
<p>:return: a number or array of adjusted temperature days</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="iwin.iparyield.model.ipar.apply_IPAR_EH" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">iparyield</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">ipar</span><span class="o">.</span><span class="n">apply_IPAR_EH</span><span class="p">(</span><span class="n">Norm_TT_EH</span><span class="p">,</span> <span class="n">norm_iPAR_EH_bounds</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span></code>

</h5>


  <div class="doc doc-contents ">
  
      <p>Calculate daily progress (Adjusted TDays)</p>
<p>:param Tavg: Number or array of Average Temperatures
:param threshold: Number of TDays. eg. IWIN: 42, Dhillon: 35, South Asia: 41</p>
<p>:return: a number or array of adjusted temperature days</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="iwin.iparyield.model.ipar.estimate_IPAR" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">iparyield</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">ipar</span><span class="o">.</span><span class="n">estimate_IPAR</span><span class="p">(</span><span class="n">Norm_TT_EH</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Norm_SimNDVI_EH</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Norm_SimNDVI_HM</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">norm_iPAR_EH_bounds</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">NDVI_constantIPAR</span><span class="o">=</span><span class="mf">0.19</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h5>


  <div class="doc doc-contents ">
  
      <p>Total light interception - iPAR</p>
<h6 id="iwin.iparyield.model.ipar.estimate_IPAR--asrar-g-fuchs-m-kanemasu-et-hatfield-jl-1984">** Asrar, G., Fuchs, M., Kanemasu, E.T., Hatfield, J.L., 1984.</h6>
<h6 id="iwin.iparyield.model.ipar.estimate_IPAR--estimating-absorbed-photosynthetic-radiation-and-leaf-area-index-from-spectral-reflectance">Estimating absorbed photosynthetic radiation and leaf area index from spectral reflectance</h6>
<h6 id="iwin.iparyield.model.ipar.estimate_IPAR--in-wheat-agron-j-76-300306">in wheat. Agron. J. 76, 300–306.</h6>
<h6 id="iwin.iparyield.model.ipar.estimate_IPAR---campos-2018-remote-sensing-based-crop-biomass-with-water-or-light-driven-crop-growth-models-in">- Campos 2018 Remote sensing-based crop biomass with water or light-driven crop growth models in</h6>
<h6 id="iwin.iparyield.model.ipar.estimate_IPAR--wheat-commercial-fields">wheat commercial fields</h6>
<p>iPAR = NDVI * 1.25 - 0.19 # between heading and maturity (Campos et al. 2018)
iPAR = NDVI * 1.25 - 0.21 Daughtry et al. (1992)</p>
<hr />
<p>:params Norm_TT_EH: 
:params Norm_SimNDVI_EH: 
:params Norm_SimNDVI_HM: 
:params norm_iPAR_EH_bounds: Bounds for iPAR multi-linear equations</p>
<p>:return: An array of Total light interception values</p>

  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">



<h4 id="iwin.iparyield.model.daylength" class="doc doc-heading">
            <code>iwin.iparyield.model.daylength</code>


</h4>

  <div class="doc doc-contents ">

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h5 id="iwin.iparyield.model.daylength.CBM_daylength" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">iparyield</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">daylength</span><span class="o">.</span><span class="n">CBM_daylength</span><span class="p">(</span><span class="n">dayOfYear</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span></code>

</h5>


  <div class="doc doc-contents ">
  
      <div class="highlight"><pre><span></span><code>A model comparison for daylength as a function of latitude and day of year
William C. Forsythe a,* Edward J. Rykiel Jr. a, Randal S. Stahl a, Hsin-i Wu a, Robert M. Schoolfield b
Ecological Modelling 80 (1995) 87-95
</code></pre></div>
<p>:param dayOfYear: Day of the Year (DOY) 
:param lat: Latitude of the site in celsius degrees
:param p: Sun angle with the horizon. eg. p = 6.0 : civil twilight,
          p = 0.0 : day starts / ends when sun is even with the horizon.
          Default value p=0</p>
<p>:return: a daylength for the specific site</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="iwin.iparyield.model.daylength.getDaylength" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">iparyield</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">daylength</span><span class="o">.</span><span class="n">getDaylength</span><span class="p">(</span><span class="n">dayOfYear</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span></code>

</h5>


  <div class="doc doc-contents ">
  
      <p>Length of the day for a specific site</p>
<p>:param dayOfYear: Day of the Year (DOY) 
:param lat: Latitude of the site in celsius degrees
:param p: Sun angle with the horizon. eg. p = 6.0 : civil twilight,
          p = 0.0 : day starts / ends when sun is even with the horizon.
          Default value p=0</p>
<p>:return: a daylength for the specific site</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="iwin.iparyield.model.daylength.apply_Daylength" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">iparyield</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">daylength</span><span class="o">.</span><span class="n">apply_Daylength</span><span class="p">(</span><span class="n">dayOfYear</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span></code>

</h5>


  <div class="doc doc-contents ">
  
      <p>Length of the day for a specific site</p>
<p>:param dayOfYear: Day of the Year (DOY) 
:param lat: Latitude of the site in celsius degrees
:param p: Sun angle with the horizon. eg. p = 6.0 : civil twilight,
          p = 0.0 : day starts / ends when sun is even with the horizon.
          Default value p=0</p>
<p>:return: a daylength for the specific site</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="iwin.iparyield.model.daylength.calculateDayLength" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">iparyield</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">daylength</span><span class="o">.</span><span class="n">calculateDayLength</span><span class="p">(</span><span class="n">d</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lat</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span></code>

</h5>


  <div class="doc doc-contents ">
  
      <p>Get Day length</p>

  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">



<h4 id="iwin.iparyield.model.ndvi" class="doc doc-heading">
            <code>iwin.iparyield.model.ndvi</code>


</h4>

  <div class="doc doc-contents ">

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h5 id="iwin.iparyield.model.ndvi.estimateNDVI_EH" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">iparyield</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">ndvi</span><span class="o">.</span><span class="n">estimateNDVI_EH</span><span class="p">(</span><span class="n">norm_TT_EH</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">NDVI_lowerThreshold</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">NDVI_Threshold</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">NDVI_max</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h5>


  <div class="doc doc-contents ">
  
      <p>Estimate NDVI values from emergence to heading.</p>
<p>Use of Normalized Thermal Time and Observed NDVI to calculate IPAR 
from Emergence to Heading</p>
<p>:params norm_TT_EH: Normilize GDD or Thermal time from Emergence to Heading
:params NDVI_lowerThreshold: Lower threshold to estimate NDVI
:params NDVI_Threshold: Threshold to estimate NDVI
:params NDVI_max: Maximum NDVI value allowed
:verbose: Display messages during the processing</p>
<p>:return: An array with NDVI values from Emergence to Heading</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="iwin.iparyield.model.ndvi.estimateNDVI_HM" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">iparyield</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">ndvi</span><span class="o">.</span><span class="n">estimateNDVI_HM</span><span class="p">(</span><span class="n">norm_TT_HM</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">NDVImax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">NDVI_atHeading</span><span class="o">=</span><span class="mf">0.94</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h5>


  <div class="doc doc-contents ">
  
      <p>Estimate NDVI values from Heading to Maturity.</p>
<p>Use of Normalized Thermal Time and Observed NDVI to calculate IPAR 
from Heading to Maturity.</p>
<p>:params norm_TT_HM: Normilize GDD or Thermal time from Heading to Maturity
:params NDVI_max: Maximum NDVI value allowed
:params NDVI_atHeading: NDVI reached at Heading date
:verbose: Display messages during the processing</p>
<p>:return: An array with NDVI values from Heading to Maturity</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="iwin.iparyield.model.ndvi.getNDVI_EH" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">iparyield</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">ndvi</span><span class="o">.</span><span class="n">getNDVI_EH</span><span class="p">(</span><span class="n">norm_TT_EH</span><span class="p">,</span> <span class="n">NDVI_lowerThreshold</span><span class="p">,</span> <span class="n">NDVI_Threshold</span><span class="p">,</span> <span class="n">NDVI_max</span><span class="p">)</span></code>

</h5>


  <div class="doc doc-contents ">
  
      <p>Estimate NDVI values from emergence to heading.</p>
<p>Use of Normalized Thermal Time and Observed NDVI to calculate IPAR 
from Emergence to Heading</p>
<p>:params norm_TT_EH: Normilize GDD or Thermal time from Emergence to Heading
:params NDVI_lowerThreshold: Lower threshold to estimate NDVI
:params NDVI_Threshold: Threshold to estimate NDVI
:params NDVI_max: Maximum NDVI value allowed
:verbose: Display messages during the processing</p>
<p>:return: An array with NDVI values from Emergence to Heading</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="iwin.iparyield.model.ndvi.apply_NDVI_EH" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">iparyield</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">ndvi</span><span class="o">.</span><span class="n">apply_NDVI_EH</span><span class="p">(</span><span class="n">norm_TT_EH</span><span class="p">,</span> <span class="n">NDVI_lowerThreshold</span><span class="p">,</span> <span class="n">NDVI_Threshold</span><span class="p">,</span> <span class="n">NDVI_max</span><span class="p">)</span></code>

</h5>


  <div class="doc doc-contents ">
  
      <p>Estimate NDVI values from emergence to heading.</p>
<p>Use of Normalized Thermal Time and Observed NDVI to calculate IPAR 
from Emergence to Heading</p>
<p>:params norm_TT_EH: Normilize GDD or Thermal time from Emergence to Heading
:params NDVI_lowerThreshold: Lower threshold to estimate NDVI
:params NDVI_Threshold: Threshold to estimate NDVI
:params NDVI_max: Maximum NDVI value allowed
:verbose: Display messages during the processing</p>
<p>:return: An array with NDVI values from Emergence to Heading</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="iwin.iparyield.model.ndvi.calculateNDVI_EH" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">iparyield</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">ndvi</span><span class="o">.</span><span class="n">calculateNDVI_EH</span><span class="p">(</span><span class="n">norm_TT_EH</span><span class="p">,</span> <span class="n">NDVI_lowerThreshold</span><span class="p">,</span> <span class="n">NDVI_Threshold</span><span class="p">,</span> <span class="n">NDVI_max</span><span class="p">)</span></code>

</h5>


  <div class="doc doc-contents ">
  
      <p>Estimate NDVI values from emergence to heading.</p>
<p>Use of Normalized Thermal Time and Observed NDVI to calculate IPAR 
from Emergence to Heading</p>
<p>:params norm_TT_EH: Normilize GDD or Thermal time from Emergence to Heading
:params NDVI_lowerThreshold: Lower threshold to estimate NDVI
:params NDVI_Threshold: Threshold to estimate NDVI
:params NDVI_max: Maximum NDVI value allowed
:verbose: Display messages during the processing</p>
<p>:return: An array with NDVI values from Emergence to Heading</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="iwin.iparyield.model.ndvi.getNDVI_HM" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">iparyield</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">ndvi</span><span class="o">.</span><span class="n">getNDVI_HM</span><span class="p">(</span><span class="n">norm_TT_HM</span><span class="p">,</span> <span class="n">NDVImax</span><span class="p">)</span></code>

</h5>


  <div class="doc doc-contents ">
  
      <p>Estimate NDVI values from Heading to Maturity.</p>
<p>Use of Normalized Thermal Time and Observed NDVI to calculate IPAR 
from Emergence to Heading</p>
<p>:params norm_TT_HM: Normilize GDD or Thermal time from Heading to Maturity
:params NDVI_max: Maximum NDVI value allowed
:verbose: Display messages during the processing</p>
<p>:return: An array with NDVI values from Heading to Maturity</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="iwin.iparyield.model.ndvi.apply_NDVI_HM" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">iparyield</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">ndvi</span><span class="o">.</span><span class="n">apply_NDVI_HM</span><span class="p">(</span><span class="n">norm_TT_HM</span><span class="p">,</span> <span class="n">NDVImax</span><span class="p">)</span></code>

</h5>


  <div class="doc doc-contents ">
  
      <p>Estimate NDVI values from Heading to Maturity.</p>
<p>Use of Normalized Thermal Time and Observed NDVI to calculate IPAR 
from Heading to Maturity.</p>
<p>:params norm_TT_HM: Normilize GDD or Thermal time from Heading to Maturity
:params NDVI_max: Maximum NDVI value allowed
:verbose: Display messages during the processing</p>
<p>:return: An array with NDVI values from Heading to Maturity</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="iwin.iparyield.model.ndvi.calculateNDVI_HM" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">iparyield</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">ndvi</span><span class="o">.</span><span class="n">calculateNDVI_HM</span><span class="p">(</span><span class="n">norm_TT_HM</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">NDVImax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">NDVI_atHeading</span><span class="o">=</span><span class="mf">0.94</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h5>


  <div class="doc doc-contents ">
  
      <p>Estimate NDVI values from Heading to Maturity.</p>
<p>Use of Normalized Thermal Time and Observed NDVI to calculate IPAR 
from Heading to Maturity.</p>
<p>:params norm_TT_HM: Normilize GDD or Thermal time from Heading to Maturity
:params NDVI_max: Maximum NDVI value allowed
:params NDVI_atHeading: NDVI reached at Heading date
:verbose: Display messages during the processing</p>
<p>:return: An array with NDVI values from Heading to Maturity</p>

  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">



<h4 id="iwin.iparyield.model.tday" class="doc doc-heading">
            <code>iwin.iparyield.model.tday</code>


</h4>

  <div class="doc doc-contents ">

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h5 id="iwin.iparyield.model.tday.calcTDay" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">iparyield</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">tday</span><span class="o">.</span><span class="n">calcTDay</span><span class="p">(</span><span class="n">Tmin</span><span class="p">,</span> <span class="n">Tmax</span><span class="p">,</span> <span class="n">tminFactor</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span></code>

</h5>


  <div class="doc doc-contents ">
  
      <p>Calculate day time temperature
    TDay = 0.75<em>Tmax + 0.25</em>TMin</p>
<p>:param Tn: Number or array of Minimum Temperatures
:param Tx: Number or array of Maximum Temperatures
:param tminFactor: Minimum Temperature factor</p>
<p>:return: a number or array of Day Temperatures</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="iwin.iparyield.model.tday.getTDay" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">iparyield</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">tday</span><span class="o">.</span><span class="n">getTDay</span><span class="p">(</span><span class="n">Tmin</span><span class="p">,</span> <span class="n">Tmax</span><span class="p">,</span> <span class="n">tminFactor</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span></code>

</h5>


  <div class="doc doc-contents ">
  
      <p>Calculate day time temperature
    TDay = 0.75<em>Tmax + 0.25</em>TMin</p>
<p>:param Tmin: Number or array of Minimum Temperatures
:param Tmax: Number or array of Maximum Temperatures
:param tminFactor: Minimum Temperature factor</p>
<p>:return: a number or array of Day Temperatures</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="iwin.iparyield.model.tday.apply_TDay" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">iparyield</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">tday</span><span class="o">.</span><span class="n">apply_TDay</span><span class="p">(</span><span class="n">Tmin</span><span class="p">,</span> <span class="n">Tmax</span><span class="p">,</span> <span class="n">tminFactor</span><span class="p">)</span></code>

</h5>


  <div class="doc doc-contents ">
  
      <p>Calculate day time temperature</p>
<p>:param Tmin: Numpy array of Minimum Temperatures
:param Tmax: Numpy array of Maximum Temperatures
:param tminFactor: Minimum Temperature factor</p>
<p>:return: a number or array of Day Temperatures</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="iwin.iparyield.model.tday.estimate_TDay" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">iparyield</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">tday</span><span class="o">.</span><span class="n">estimate_TDay</span><span class="p">(</span><span class="n">Tmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Tmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tminFactor</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span></code>

</h5>


  <div class="doc doc-contents ">
  
      <p>Calculate day time temperature</p>
<p>:param Tmin: Numpy array of Minimum Temperatures
:param Tmax: Numpy array of Maximum Temperatures
:param tminFactor: Minimum Temperature factor</p>
<p>:return: a number or array of Day Temperature</p>

  </div>

</div>



  </div>

  </div>

</div>


  </div>

  </div>

</div>


  </div>

  </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="iwin.data" class="doc doc-heading">
            <code>iwin.data</code>


</h2>

  <div class="doc doc-contents ">

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="iwin.data.load_data" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">load_data</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Load IWIN and AgERA5 datasets in parquet format
    Reading the Parquet format is much more efficient.</p>
<p>:return: Two dataframes for crop phenology and weather dataset respectively.</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.data.load_IWINdataset" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">load_IWINdataset</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">imputingData</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cleanSD</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">missigHisto</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">saveHistoFig</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">saveRawFile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Load updated IWIN dataset</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.data.filterPhenologyData" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">filterPhenologyData</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fld</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">selcols</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Filter dataset by Nursery</p>
<p>:params data: A table or DF with trial for each site</p>
<p>:results: An array or DF of filtered sites</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.data.imputingMissingValues" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">imputingMissingValues</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Imputation preserves all cases by replacing missing data with an estimated value based on the average of the site-nursery-year. 
Once all missing values have been imputed, the data set can then be analysed using standard techniques for complete data.</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.data.displaySummaryByNursery" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">displaySummaryByNursery</span><span class="p">(</span><span class="n">df_N</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nursery</span><span class="o">=</span><span class="s1">&#39;NURSERY&#39;</span><span class="p">,</span> <span class="n">MIN_PERC</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">MAX_PERC</span><span class="o">=</span><span class="mi">98</span><span class="p">,</span> <span class="n">KDEHist</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sel_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;GRAIN_YIELD&#39;</span><span class="p">,</span> <span class="s1">&#39;1000_GRAIN_WEIGHT&#39;</span><span class="p">,</span> <span class="s1">&#39;DAYS_TO_HEADING&#39;</span><span class="p">,</span> <span class="s1">&#39;DAYS_TO_ANTHESIS&#39;</span><span class="p">,</span> <span class="s1">&#39;DAYS_TO_MATURITY&#39;</span><span class="p">,</span> <span class="s1">&#39;PLANT_HEIGHT&#39;</span><span class="p">,</span> <span class="s1">&#39;TEST_WEIGHT&#39;</span><span class="p">],</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <ul>
<li>Cut-off by using percentiles 5% and 98%</li>
</ul>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.data.joinBLUPnBLUE_andNormilizedYield_GrpByGID" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">joinBLUPnBLUE_andNormilizedYield_GrpByGID</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">BLU</span><span class="p">,</span> <span class="n">stats</span><span class="p">,</span> <span class="n">nursery</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">saveFile</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Join BLUP and BLUE values, and Normalize Yield</p>
<p>It uses 95th percentile of yield (top 5%) of each site-year as a reference and express the yield 
of each GID within a site-year in percent of the top yield.</p>
<p>Return a group by GID table</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.data.getStatsByTrial" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">getStatsByTrial</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">df_final</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;parquet&#39;</span><span class="p">,</span> <span class="n">saveFile</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Estimate stats (BLUEs, BLUPs, Heritability, CV, LSD, Genotype significance, among others) for each individual trial.</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.data.createArrayOfObjects_toRunInParallel" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">createArrayOfObjects_toRunInParallel</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Create an array of sites with the IWIN observations to speed up further analysis
This array of objects is useful to run models in parallel.</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="iwin.data.formatFeaturesforIWIN" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iwin</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">formatFeaturesforIWIN</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">removeObsPheno</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">arrObj</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Features or columns in IWIN table need to rename and reformat according to the original IWIN package or library.</p>
<ul>
<li>Nursery is needed to evaluate the Equation to use in grain filling</li>
<li>Rename columns to match with the IWIN library</li>
<li>Create array of objects to run models in parallel</li>
</ul>

  </div>

</div>



  </div>

  </div>

</div>


  </div>

  </div>

</div><p>...</p>
<h2 id="references">References</h2>





                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2021 - 2023 <a href="https://github.com/egiron" target="_blank" rel="noopener">Ernesto Giron E.</a>
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/egiron" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/egirongis" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/in/ernesto-giron-808b6625/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["header.autohide", "navigation.tabs", "navigation.sections", "toc.integrate", "navigation.top", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotation", "content.code.copy"], "search": "../assets/javascripts/workers/search.dfff1995.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.78eede0e.min.js"></script>
      
    
  </body>
</html>